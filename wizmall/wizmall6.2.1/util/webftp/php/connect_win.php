<?php
/**
* FTP 접속하기 창
*
* @filename : php/connect_win.php
* @version  : v 1.0 2003.07.08 18:41
* @author   : nsl <smpoem@magicn.com>
*/

$_HEADER_TITLE = ':: 접속 하기 :: ';

$_SKYDIR_URL = '../';

// 기본 설정 초기화
include '../common/skydir_init.php';

if (empty($fcode)) $fcode = 'init';

if ($wmode == "win")
    $bodyOnload = 'OnLoad="self.focus();window.onblur=function(){ if(!opener.closed) window.focus()};"';

include '../class/sky_html_class.php';

// ftp class 초기화
$ftp = new SkyFtp($rcfg->ftpHost, $rcfg->ftpPort, $rcfg->ftpUserID, $rcfg->ftpUserPW);
// ftp 연결
if (!$ftp->ftpLogin()) {

    $ftp->ftpClose();
    $isFtpCon = false;
}
$ftp->ftpClose();


// html 시작부
include (HEADER_FILE);

?>
<script language="javascript">
<!--

    function setWinClose() {

        if ( opener.closed )  window.close()
    }
//   setInterval("setWinClose()", 100); 


    function goConfig(code) {

        location.href= '<?=$_SERVER[PHP_SELF]?>' + '?wmode=<?=$wmode?>&code=' + code;        
    }

    // uconfig_save.php 에도 있음
    function configWinClose() {

       <?  
           // 이렇게 구분하지 않으면 자바스크립트 에러남
           // FTP 연결이면
           if ($isFtpCon && $install != 'first') {
       ?>
           var cd =  parent.opener.top.right.layerCode.cd.value;
       <?
           } else { 
           // 접속 실패이면 초기 디렉토리
       ?>
           var cd = '<?=$rcfg->initDirRight?>';
       <? } ?>

       parent.opener.top.dtop.location.href =  '../main/<?=$dcfg->topFile?>' + '?cd=' + cd;
       parent.opener.top.left_top.location.href =  '../main/left_top.php' + '?cd=' + cd;
       parent.opener.top.left.location.href =  '../main/<?=$dcfg->leftFile?>' + '?cd=' + cd;
       parent.opener.top.right.location.href = '../main/<?=$dcfg->rightFile?>?rf=1' + '&cd=' + cd;
      //parent.opener.top.location.reload();
       window.close();
    }


//-->
</script>
</head>
<body  leftmargin="0" topmargin="0" marginwidth="0" marginheight="0" bgcolor="<?=$rcfg->winColor?>" <?=$bodyOnload?> <?=$dcfg->body?>>
<table border=0 cellpadding=0 cellspacing=0 width=98% height=98% align=center style="margin:5px">
<tr>
  <td>
<?

    switch($code) {

        // 접속창
        case 'connect_win' : include 'connect_wins.php'; break;

        default :

    } // switch End

?>
  </td>
</tr>
<tr>
  <td height=30 valign=middle>

  <table border=0 cellpadding=0 cellspacing=0 valign=middle  align=center width=95%>
  <tr>
    <td height=5></td>
  </tr>
  <tr>
    <td align=right>
      <input type=submit value=" <?=$lg->butOk?> "     class=but_config> 
      <input type=button value=" <?=$lg->butCancel?> " class=but_config OnClick="configWinClose()"> 
      <input type=button value=" <?=$lg->butApply?> "  class=but_config name=applyBut disabled OnClick="applyCheck()"> 
    </td>

    </form>
  </tr>
<!--  <tr>
    <td height=10></td>
  </tr>
  <tr>
    <td align=center><?=$dcfg->pgCopyright?></td>
  </tr>
  <tr>
    <td height=3></td>
  </tr> -->
  </table>

</tr>
<tr>
  <td height=5></td>
</tr>
</table>
<script language="javascript">
<!--

    isSubmit = true;
    // 적용버튼 클릭시
    function applyCheck() {

        var f = document.input;
        f.apply.value = 'ok';
        
        inputCheck();

        if (isSubmit)
            f.submit();
    }

    // 적용버튼 활성화
    function setApplyBut() {

        document.input.applyBut.disabled = false;
    }

//-->
</script>
</body>
</html>