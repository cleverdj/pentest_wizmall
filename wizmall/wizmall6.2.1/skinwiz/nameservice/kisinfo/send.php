<?php 
// =============================================//
// version : 1.5 (2003.07.3)
// 사용방법 : 
// nc_p.php Page에 Post 방식으로 a1=이름,a2=주민번호를 보낸다.
// =============================================//

// =============================================//
// 회원사 ID, 비밀번호 및 기타  설정
// =============================================//
// sURLnc의 값을 실제 이 페이지를 부르는 page로 설정해야 동작합니다.
// 외부 사용자가 이 URL을 스크래핑하여 불법으로 사용하는 것을 막기 위함.

// 	define("sURLnc", "@URLNC.PHP");   	// 이전 URL을 입력하세요. 
//	define("sURLnc", "http://www.test.co.kr/nc.php");

// @SITEID 및 @SITEPW 를 실제 부여 받은 사이트 id 및 패스워드로 로 바꾸기 바람니다.

$sSiteID = "@SITEID";  	// 사이트 id 
$sSitePW = "@SITEPW";   // 비밀번호
$cb_encode_path = "./cb_namecheck";			// cb_namecheck 모듈이 설치된 위치 

// ============================================ //
// Main 시작 
// ============================================ //
// Passed Data value : 
// $a1 : 이름 
// $a2 : 주민번호
// ============================================ //

	$strJumin= $jumin1.$jumin2;		// 주민번호
	$strName = $name;		//이름
	
	$iReturnCode  = "";	

	// sURLnc의 값을 실제 이 페이지를 부르는 page(HTTP_REFERER)로 설정해야 동작합니다.
	// echo "HTTP_REFERER=($HTTP_REFERER)"; 로 값을 확인해 볼수 잇습니다.
	// nc_p.php 페이지를 외부 사용자가 불법으로 사용하는 것을 막기 위함.
//	if ($HTTP_REFERER == sURLnc)
//	 {
		$iReturnCode = `$cb_encode_path $sSiteID $sSitePW $strJumin $strName`;				
//	 }

	//echo "성명확인 서비스 결과<hr><p>성명 확인 결과 값이 저장된 \$iReturnCode를 이용하여 회원사 추가처리 루틴을 삽입<P>";
	//echo "iReturnCode=($iReturnCode)" ;
	
	switch("$iReturnCode"){
		case("1"):
			//성인쿠키설정
			setcookie("MEMBER_ADULT", "$strJumin", 0, "/");
			header("location:../../../index.php");
		break;
		case("2"):
			echo "<script>alert('본인 아님');history.go(-1);</script>";
		break;
		case("3"):
			echo "<script>alert('자료없음');history.go(-1);</script>";
		break;
		case("4"):
			echo "<script>alert('kis 시스템 장애.');history.go(-1);</script>";
		break;
		case("5"):
			echo "<script>alert('주민번호 오류');history.go(-1);</script>";
		break;
		case("9"):
			echo "<script>alert('request 데이타 오류.(주민번호, 비밀번호, 사이트아이디, 성명 중 한개의 데이터라도 빠지거나 오류가 있는 경우)');history.go(-1);</script>";
		break;
		case("10"):
			echo "<script>alert('사이트코드 오류');history.go(-1);</script>";
		break;
		case("11"):
			echo "<script>alert('사이트 정지상태임');history.go(-1);</script>";
		break;
		case("12"):
			echo "<script>alert('사이트 패스워드 오류');history.go(-1);</script>";
		break;
		case("13"):
			echo "<script>alert('사이트 인증시스템 장애');history.go(-1);</script>";
		break;
		case("15"):
			echo "<script>alert('Decoding 오류(Data)');history.go(-1);</script>";
		break;
		case("16"):
			echo "<script>alert('Decoding 시스템장애');history.go(-1);</script>";
		break;
		case("21"):
			echo "<script>alert('암호화 데이터 에러.(주민번호_비밀번호 자릿수가 21이 아닐경우)');history.go(-1);</script>";
		break;
		case("24"):
			echo "<script>alert('암호화 연산중 에러');history.go(-1);</script>";
		break;
		case("31"):
			echo "<script>alert('연결장애');history.go(-1);</script>";
		break;
		case("32"):
			echo "<script>alert('결과값 이상…(result= ) 형식으로 데이터가 넘어오지 않은 경우…');history.go(-1);</script>";
		break;
		case("34"):
			echo "<script>alert('통신중 장애발생');history.go(-1);</script>";
		break;																																				
		//default("0"):
		//break;	
	}
?>