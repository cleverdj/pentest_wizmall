<table width="100%" border="0" cellspacing="2" cellpadding="9" style="border:4px #f0f0f0 solid">
  <tr>
    <td colspan="2" height="1" bgcolor="dddddd"></td>
  </tr>
  <tr>
    <td width="150" bgcolor="f9f9f9" ><strong><font color="585858"><?=$mall->navy_title?></font></strong></td>
    <td align=center><table width="100%"cellspacing="0" cellpadding="0">
        <tr>
<?
$cntstr = "select sum(pcnt) as pcnt, cat_no from wizCategory $mall->categoryCntWhere group by cat_no";
unset($pdcntArr);
$cntqry = $dbcon->_query($cntstr);
while($cntlist = $dbcon->_fetch_array($cntqry)):
	$cat_no = $cntlist["cat_no"];
	$pcnt = $cntlist["pcnt"];
	$pdcntArr[$cat_no] = $pcnt;
endwhile;


$catstr = "select cat_name, cat_no from wizCategory $mall->categoryWhere";
$catqry = $dbcon->_query($catstr);
$cnt=0;
while($list = $dbcon->_fetch_array($catqry)){
	$cat_name = $list["cat_name"];
	$cat_no = $list["cat_no"];
	$pcdnt = 0;
	
	//echo "count = ".count($pdcntArr)."<br>";
	foreach($pdcntArr as $key=>$value){	
		$substrlen = (strlen(intval($cat_no))/2)*2;
	//	echo "<br>cat_no = $cat_no ,key = $key , substrlen = ".((strlen(intval($cat_no))/2)*2)." <br>";
		if(substr($key, -$substrlen)  == $cat_no) $pcdnt += $value;
	}

		
if($cnt%4) echo "<td width=1><font color='#dddddd'> | </font> </td>";
?>        
          <td style="padding-left:3pt;" width="25%"><a href="wizmart.php?code=<?=$cat_no;?>"><?=$cat_name;?></a><? echo "(".$pcdnt.")"?> </td>
<?
$cnt++;
if(!($cnt%4)) echo "</tr><tr>";
}//while($list = $dbcon->_fetch_array($catqry)){
$tmpcnt = $NO%4;
if($tmpcnt){
	for($i=$tmpcnt; $i<4; $i++){
		echo "<td width=1></td><td style='padding-left:3pt;' width='25%'></td>";
	}
}
?>          
        </tr>
      </table></td>
  </tr>
  <tr>
    <td colspan="2" height="1" bgcolor="dddddd"></td>
  </tr>
</table>