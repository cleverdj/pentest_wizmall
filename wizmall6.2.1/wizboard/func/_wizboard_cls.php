<?
class wizBoard_Class{

	function wizBoard_Class($MYSQL_HOST, $MYSQL_DB, $MYSQL_ID, $MYSQL_PASSWORD){
		$this->MYSQL_HOST=$MYSQL_HOST;
		$this->MYSQL_DB = $MYSQL_DB;
		$this->MYSQL_ID = $MYSQL_ID;
		$this->MYSQL_PASSWORD = $MYSQL_PASSWORD;
	}
	
	function db_connect(){
		$this->dbcon=mysql_connect($this->MYSQL_HOST,  $this->MYSQL_ID, $this->MYSQL_PASSWORD);
		mysql_select_db($this->MYSQL_DB, $this->dbcon);
		if ( !$this->dbcon ) {
			echo "mysql 데이터 베이스에 연결할 수 없습니다."; 
			exit;
		}	
	}
	
	function dberror($str){
		die($str."<br>".mysql_error());
	}
	
	function js_alert($str, $goto=null){
		if($goto == "cur"){
			echo "<script>alert('$str');</script>";
			return false;
			exit;
		}else if($goto == "close"){
			echo "<script>alert('$str');self.close();</script>";
			return false;
			exit;
		}else{
			echo "<script>alert('$str');history.go(-1);</script>";
			return false;
			exit;
		}
	}	
	
####################################################################################
#### 게시물 갯수 구하기
####################################################################################
	function getPageCount(){
		$sqlstr = "SELECT count(UID) FROM ".$this->tablename." ". $this->where;
		$sqlqry = mysql_query($sqlstr) or $this->dberror($sqlstr);
		$this->total = @mysql_result($sqlqry, 0, 0);
		mysql_free_result($sqlqry);

		if(empty($this->CP) || $this->CP <= 0) $this->CP = 1;

		//--페이지 나타내기--
		/* 하단 페이지수 표시 for ($i = $SP; $i <= $EP && $i <= $TP ; $i++) */
		$this->TP = ceil($this->total / $this->ListNo) ; /* 총페이지수(Total Page) : 총게시물수 / 페이지당 리스트수  */
		$this->CB = ceil($this->CP / $this->PageNo); /* 현재블록(Current Block) : 현재페이지 / 표시되는 페이지 수 */
		$this->SP = ($this->CB - 1) * this->$PageNo + 1; /* 블록의 처음 페이지(Start Page) 구하기 */
		$this->EP = ($this->CB * $this->PageNo); /*블록의 마지막 페이지(End Page) : 현재 블록 * 표시되는 페이지수 */
		$this->TB = ceil($this->TP / $this->PageNo); /* 총블록수(Total Block) : 총페이지수 / 표시되는 페이지 수 */
	}



function getPaging(){
	
	if(!$this->targetpage) $this->targetpate = $PHP_SELF;

	$TransData = "BID=$BID&GID=$GID&adminmode=$adminmode&optionmode=$optionmode&SEARCHTITLE=$SEARCHTITLE&searchkeyword=".urlencode($searchkeyword)."&category=$category&STitle=$STitle&SOrder=$SOrder&search_term=$search_term";
	if ( $CB > 1 ) {
	$PREV_PAGE = $SP - 1;
	echo " <a href='".$this->targetpage."?$this->CP=$PREV_PAGE&$this->TransData'><img src='./wizboard/skin_btnm/$BOTTOM_SKIN_TYPE/pre.gif' border='0'></a> ";
	} else {
	echo " <img src='./wizboard/skin_btnm/$BOTTOM_SKIN_TYPE/pre.gif' border='0'> ";
	 }

	# 한페이지 이전
	if ( $$this->CP > 1 ) {
	$PREV_PAGE = $$this->CP - 1;
	echo " <a href='".$this->targetpage."?$this->CP=$PREV_PAGE&$this->TransData'><img src='./wizboard/skin_btnm/$BOTTOM_SKIN_TYPE/pre1.gif' border='0'></a> ";
	} else {
	echo " <img src='./wizboard/skin_btnm/$BOTTOM_SKIN_TYPE/pre1.gif' border='0'> ";
	 }

	/* LISTING NUMBER PART */
	for ($i = $SP; $i <= $EP && $i <= $TP ; $i++) {
	if($$this->CP == $i){$NUMBER_SHAPE= "<B>${i}</B>";}
	else $NUMBER_SHAPE=${i};
	ECHO" <A HREF='".$this->targetpage."?$this->CP=$i&$this->TransData'>$NUMBER_SHAPE</a> ";
	}
	# 한페이지 다음
	if ($$this->CP < $TP) {
	$NEXT_PAGE = $$this->CP + 1;
	ECHO " <a href='".$this->targetpage."?$this->CP=$NEXT_PAGE&$this->TransData'><img src='./wizboard/skin_btnm/$BOTTOM_SKIN_TYPE/next1.gif' border='0'></a> ";
	} else {
	ECHO" <img src='./wizboard/skin_btnm/$BOTTOM_SKIN_TYPE/next1.gif' border='0' >";
	}

	/* NEXT or END PART */
	if ($CB < $TB) {
	$NEXT_PAGE = $EP + 1;
	ECHO " <a href='".$this->targetpage."?$this->CP=$NEXT_PAGE&$TransData'><img src='./wizboard/skin_btnm/$BOTTOM_SKIN_TYPE/next.gif' border='0'></a> ";
	} else {
	ECHO" <img src='./wizboard/skin_btnm/$BOTTOM_SKIN_TYPE/next.gif' border='0'> ";
	}
}

?>