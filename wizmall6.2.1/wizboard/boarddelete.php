<?
/* 
제작자 : 폰돌
URL : http://www.shop-wiz.com
Email : master@shop-wiz.com
*** Updating List ***
*/

include "../lib/cfg.common.php";
include "../config/db_info.php";
$BOARD_NAME="wizTable_${AdminBID}";

include "../lib/class.database.php";
$dbcon	= new database($cfg["sql"]);

include "../lib/class.common.php";
$common = new common();
//$common->db_connect($dbcon);

if($mode==ok) {
	if($UID=='') $common->js_windowclose("잘못된 경로의 접근입니다.");


/******** 업로딩된 파일 삭제 **************/

	$sqlstr="SELECT UPDIR1 FROM $BOARD_NAME WHERE UID='$UID'";
	$LIST1= $dbcon->get_one($sqlstr);
	$Updir = split("\|", $LIST1);
	for($i=0; $i < sizeof($Updir); $i++){
		if($Updir[$i] && file_exists("../config/wizboard/table/${BID}/updir/$Updir[$i]")) {
			unlink("../config/wizboard/table/$BID/updir/$Updir[$i]");
		}
	}

	
/******* 리플 테이블로 부터 정보 삭제 *********/	
	$sqlstr="DELETE FROM ${BOARD_NAME}_reply WHERE MID='$UID'";
	$dbcon->_query($sqlstr);
/******* 테이블로 부터 정보 삭제 *********/
	$sqlstr="DELETE FROM $BOARD_NAME WHERE UID='$UID'";
	$dbcon->_query($sqlstr);
	$goto = "$Goto?AdminBID=$AdminBID&cp=$cp&$menu=show&theme=boardadmin";
	$common->js_windowclose("게시물을 삭제했습니다.", $goto);
}
$str	= "정말로 삭제하시겠습니까?";
$goto	= $PHP_SELF."?UID=".$UID."&cp=".$cp."&SUB_cp=".$SUB_cp."&AdminBID=".$AdminBID."&ListCount=".$ListCount."mode=ok&Goto=".$Goto."&menu=".$menu."&theme=".$theme."&CP=".$CP;
$act	= "self.close();";
$common->js_confirm($str, $goto, $act="history.go(-1);");
?>