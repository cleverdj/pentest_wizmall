<?
/*
제작자 : 폰돌
URL : http://www.shop-wiz.com
Email : master@shop-wiz.com
*** Updating List ***
*/
$mid = $cfg["member"]["mid"];

if(!$cfg["member"]){
	echo "<script>alert('로그인후 이용해주시기 바랍니다.');history.go(-1)'</script>";
	exit;
}

?>
<script language=javascript src="./js/wizmall.js"></script>
<script language=javascript>
/*  실제 유효  */
/////////////////////////////////////////////////////////////////////////////////
function OpenZipcode(){
window.open("./util/zipcode/zipcode.php?form=FrmUserInfo&zip1=zip1_1&zip2=zip1_2&firstaddress=address1&secondaddress=address2","ZipWin","width=490,height=250,toolbar=no,location=no,directories=no,status=no,menubar=no,scrollbars=yes,resizable=no");
}
function OpenZipcode1(){
window.open("./util/zipcode/zipcode.php?form=FrmUserInfo&zip1=zip2_1&zip2=zip2_2&firstaddress=address3&secondaddress=address4","ZipWin","width=490,height=250,toolbar=no,location=no,directories=no,status=no,menubar=no,scrollbars=yes,resizable=no");
}

////////////////////////////////////////////////////////////////////////////////
function MemberCheckField()
{
var f=document.FrmUserInfo;

	if (f.ppasswd.value.length=="") {
	alert("비밀번호를 넣어주세요");
	f.ppasswd.focus();
	return false;
	}
	
	if (f.passwd.value && f.passwd.value.length < 4) {
	alert("비밀번호는 4자 이상이어야 합니다. ");
	f.passwd.focus();
	return false;
	}
	
	if (f.passwd.value && (f.passwd.value) != (f.cpasswd.value)) {
	alert("비밀번호재확인을 정확히 입력해 주세요. ");
	f.cpasswd.focus();
	return false;
	}

	if(!IsEmailChk(f.email_1.value+"@"+f.email_2.value)){ //이메일 유효성검사
	f.email_1.focus();
	return false;
	}
	
	if  (f.address1.value.length < 5) {
	alert("주소를 정확히 입력해 주세요.");
	f.address1.focus();
	return false;
	}  
	if  (f.address2.value.length < 2) {
	alert("번지수/통/반을 정확히 입력해 주세요.[예:123번지] ");
	f.address2.focus();
	return false;
	} 

return true;
}


function FillBirthDay()
{
var f=document.FrmUserInfo;

	if ( ! TypeCheck(f.jumin1.value, NUM)) {
	alert("주민등록 번호에 잘못된 문자가 있습니다. ");
	f.jumin1.focus();
	return false;
	}
	
	num = f.jumin1.value;
	
	mm = parseInt(num.substring(2,4), 10);
	dd = parseInt(num.substring(4,6), 10);
	
	if ((mm < 1) || (mm > 12)) {
	alert ("주민등록 번호 앞자리가 잘못되었습니다.");
	return false;
	}
	
	if ((dd < 1) || (dd > 31)) {
	alert ("주민등록 번호 앞자리가 잘못되었습니다.");
	return false;
	}
	
	f.birthyy.value = "19" + num.substring(0,2);
	f.birthmm.value = num.substring(2,4);
	f.birthdd.value = num.substring(4,6);
	
	
	f.jumin2.focus();
}
</script>
<?
$sqlstr = "select m.*, i.* from wizMembers m left join wizMembers_ind i on m.mid = i.id where m.mid = '".$mid."'";
$dbcon->_query($sqlstr);
$list = $dbcon->_fetch_array();
$zip1 = split("\-", $list[zip1]);
$zip2 = split("\-", $list[zip2]);
$tel1 = split("\-", $list[tel1]);
$tel2 = split("\-", $list[tel2]);
$fax = split("\-", $list[fax]);
$companynum = split("\-", $list[companynum]);
$birthdate = split("\/", $list[birthdate]);
$marrdate = split("\/", $list[marrdate]);
$email = split("\@", $list[email]);
?>
<table width="100%" border="0" cellspacing="0" cellpadding="0">
  <tr> 
    <td><table width="100%" height="18" border="0" cellpadding="0" cellspacing="0" style="font-family: '굴림', '돋움','Arial';font-size: 12px; color:#666666;line-height:140%">
        <tr bgcolor="#F6F6F6"> 
          <td width="15" height="22" class="company">&nbsp;</td>
          <td width="18" height="22" valign="middle"><img src="wizmember/<?=$cfg["skin"]["MemberSkin"]?>/images/sn_arrow.gif" width="13" height="13"></td>
          <td height="22" class="company">Home &gt; 회원정보변경 및 탈퇴</td>
        </tr>
      </table>
      <br> </td>
  </tr>
  <tr> 
    <td align="center"> <table width="95%" border="0" cellspacing="0" cellpadding="5" style="font-family: '굴림', '돋움','Arial';font-size: 12px; color:#666666;line-height:140%">
        <tr> 
          <td bgcolor="#EEEEEE">- 회원정보를 수정하는 란입니다.<br>
            - 아래의 내용중 수정을 원하시는 부분을 입력하신 후 [확인]단추를 누르세요</td>
        </tr>
      </table></td>
  </tr>
  <FORM name="FrmUserInfo" method="post" OnSubmit="return MemberCheckField();" action="./wizmember/<?=$cfg["skin"]["MemberSkin"]?>/MEMBER_MODIFYQUERY.php">
    <tr> 
      <td align="center"><br> <table width="95%" border="0" cellpadding="0" cellspacing="0" style="font-family: '굴림', '돋움','Arial';font-size: 12px; color:#666666;line-height:140%">
          <tr> 
            <td width="615" height="3" bgcolor="#cccccc"></td>
          </tr>
          <tr> 
            <td> <table width="100%" border="0" cellpadding="0" cellspacing="0" style="font-family: '굴림', '돋움','Arial';font-size: 12px; color:#666666;line-height:140%">
                <tr> 
                  <td align="right" bgcolor="#F5F5F5" width="130" height="30"><font color="#CC3333">*</font> 
                    회원 ID </td>
                  <td align="center" bgcolor="#F5F5F5" width="9"></td>
                  <td align="center" bgcolor="#CCCCCC" width="1"></td>
                  <td align="center" width="9"></td>
                  <td bgcolor="#FFFFFF"> 
                    <?=$mid?>
                    <input type="hidden" name="id" value="<?=$mid?>">                    </td>
                </tr>
                <tr> 
                  <td bgcolor="#F5F5F5" align="right" height="30">현재 비밀번호</td>
                  <td align="center" bgcolor="#F5F5F5" width="9"></td>
                  <td align="center" bgcolor="#CCCCCC" width="1"></td>
                  <td align="center" width="9"></td>
                  <td bgcolor='#FFFFFF'> <input name="ppasswd" type="password" style="font: 9pt 굴림; border:1 solid #cccccc;" size="15" maxlength="30" >                  </td>
                </tr>
                <tr> 
                  <td bgcolor="#F5F5F5" align="right" height="30">새 비밀번호</td>
                  <td align="center" bgcolor="#F5F5F5" width="9"></td>
                  <td align="center" bgcolor="#CCCCCC" width="1"></td>
                  <td align="center" width="9"></td>
                  <td bgcolor='#FFFFFF'> <input name="passwd" type="password" id="passwd" style="font: 9pt 굴림; border:1 solid #cccccc;" size="15" maxlength="30" ></td>
                </tr>
                <tr> 
                  <td bgcolor="#F5F5F5" align="right" height="30">비밀번호 확인</td>
                  <td align="center" bgcolor="#F5F5F5" width="9"></td>
                  <td align="center" bgcolor="#CCCCCC" width="1"></td>
                  <td align="center" width="9"></td>
                  <td bgcolor='#FFFFFF'> <input name="cpasswd" type="password" id="cpasswd" style="font: 9pt 굴림; border:1 solid #cccccc;" size="15" maxlength="30" >                  </td>
                </tr>
                <tr> 
                  <td bgcolor="#F5F5F5" align="right" width="130" height="30"><font color="#CC3333">*</font> 
                    이름</td>
                  <td align="center" bgcolor="#F5F5F5" width="9"></td>
                  <td align="center" bgcolor="#CCCCCC" width="1"></td>
                  <td align="center" width="9"></td>
                  <td bgcolor='#FFFFFF'> 
                    <?=$list[mname]?>
                    <input name="name" type="hidden" id="name" value="<?=$list[mname]?>">                  </td>
                </tr>
                <?if(!strcmp($cfg["mem"]["ESex"],"checked")):?>
                <tr> 
                  <td bgcolor="#F5F5F5" align="right" width="130" height="30">성 
                    별</td>
                  <td align="center" bgcolor="#F5F5F5" width="9"></td>
                  <td align="center" bgcolor="#CCCCCC" width="1"></td>

                  <td align="center" width="9"></td>
                  <td bgcolor='#FFFFFF'> <input name="gender" type="radio" value="1" <?if(!strcmp($list[gender], "1")) echo"checked";?>>
                    남자 &nbsp; <input type="radio" name="gender" value="2" <?if(!strcmp($list[gender], "2")) echo"checked";?>>
                    여자</td>
                </tr>
                <? endif; ?>
                <tr> 
                  <td bgcolor="#F5F5F5" align="right" height="30"><font color="#CC3333">*</font> 
                    주민등록번호</td>
                  <td align="center" bgcolor="#F5F5F5" width="9"></td>
                  <td align="center" bgcolor="#CCCCCC" width="1"></td>
                  <td align="center" width="9"></td>
                  <td bgcolor='#FFFFFF'> 
                    <?=$list[jumin1]?>
                    - 
                    <?=$list[jumin2]?><input type="hidden" name="jumin1" value="<?=$list[jumin1]?>">
					<input type="hidden" name="jumin2" value="<?=$list[jumin2]?>">                  </td>
                </tr>
<? if(!strcmp($PasswordHintEnable,"checked")):?>				
                <tr>
                  <td bgcolor="#F5F5F5" align="right" width="130" height="30"><font color="#CC3333">*</font> 비밀번호 
                        분실시 질문</td>
                  <td align="center" bgcolor="#F5F5F5" width="9"></td>
                  <td align="center" bgcolor="#CCCCCC" width="1"></td>
                  <td align="center" width="9"></td>
                  <td bgcolor='#FFFFFF' align='left' colspan="3"><select name="pwdhint" class=select id="pwdhint">
                          <option value=''>선택하십시오.</option>
<?
reset($PasswordHintArr);
while(list($key, $value) = each($PasswordHintArr)):
	$selected = ($list["pwdhint"] == $value)?" selected":"";
	echo "<option value='$value'$selected>$value</option>\n";
endwhile;
?></select>                  </td>
                </tr>
                <tr>
                  <td bgcolor="#F5F5F5" align="right" width="130" height="30"><font color="#CC3333">*</font> 비밀번호 
                        분실시 답변</td>
                  <td align="center" bgcolor="#F5F5F5" width="9"></td>
                  <td align="center" bgcolor="#CCCCCC" width="1"></td>
                  <td align="center" width="9"></td>
                  <td bgcolor='#FFFFFF' align='left' colspan="3"><input name="pwdanswer" type="text" id="pwdanswer" style="font: 9pt 굴림; border:1 solid #cccccc" value="<?=$list[pwdanswer]?>" size="20" maxlength="30" >                  </td>
                </tr>	
<? endif;?>				
                <?if(!strcmp($cfg["mem"]["EBirthDay"],"checked")):?>
                <tr> 
                  <td bgcolor="#F5F5F5" align="right" height="30">생년월일</td>
                  <td align="center" bgcolor="#F5F5F5" width="9"></td>
                  <td align="center" bgcolor="#CCCCCC" width="1"></td>
                  <td align="center" width="9"></td>
                  <td bgcolor='#FFFFFF'> <select name="birthyy" id="birthyy">
				  <option value=''>년도</option>
                      <?
for($i=1950; $i<date("Y"); $i++){
$selected = $birthdate[0] == $i ? "selected":"";
echo "<option value='$i' $selected>$i</option>\n";
}
?>
                    </select>
                    년
<select name="birthmm" id="birthmm">
				  <option value=''>월</option>
                      <?
for($i=1; $i<13; $i++){
$selected = $birthdate[1] == $i ? "selected":"";
echo "<option value='$i' $selected>$i</option>\n";
}
?>
                    </select>
                    월
<select name="birthdd" id="birthdd">
				  <option value=''>일</option>
                      <?
for($i=1; $i<32; $i++){
$selected = $birthdate[2] == $i ? "selected":"";
echo "<option value='$i' $selected>$i</option>\n";
}
?>
                    </select>					

                    일&nbsp;&nbsp;&nbsp; <input type="radio" name="BirthType" value="0" <?if(!strcmp($list[BirthType], "0")) echo"checked";?>>
                    양력 
                    <input type="radio" name="BirthType" value="1" <?if(!strcmp($list[BirthType], "1")) echo"checked";?>>
                    음력 </td>
                </tr>
                <? endif;?>
                <?if(!strcmp($cfg["mem"]["EMarrStatus"],"checked")):?>
                <tr> 
                  <td bgcolor="#F5F5F5" align="right" height="30">결혼여부</td>
                  <td align="center" bgcolor="#F5F5F5" width="9"></td>
                  <td align="center" bgcolor="#CCCCCC" width="1"></td>
                  <td align="center" width="9"></td>
                  <td bgcolor='#FFFFFF'><select name="marryy" id="marryy">
				  <option value=''>년도</option>
                      <?
for($i=1950; $i<date("Y"); $i++){
$selected = $marrdate[0] == $i ? "selected":"";
echo "<option value='$i' $selected>$i</option>\n";
}
?>
                    </select>
                    년
<select name="marrmm" id="marrmm">
				  <option value=''>월</option>
                      <?
for($i=1; $i<13; $i++){
$selected = $marrdate[1] == $i ? "selected":"";
echo "<option value='$i' $selected>$i</option>\n";
}
?>
                    </select>
                    월
<select name="marrdd" id="marrdd">
				  <option value=''>일</option>
                      <?
for($i=1; $i<32; $i++){
$selected = $marrdate[2] == $i ? "selected":"";
echo "<option value='$i' $selected>$i</option>\n";
}
?>
                    </select>					

                    일&nbsp;&nbsp;&nbsp; <input type="radio" name="MarrStatus" value="미혼" <?if(!strcmp($list[MarrStatus], "미혼")) echo"checked";?>>
                    미혼 
                    <input type="radio" name="MarrStatus" value="기혼" <?if(!strcmp($list[MarrStatus], "기혼")) echo"checked";?>>
                    기혼 </td>
                </tr>
                <? endif;?>
                <?if(!strcmp($cfg["mem"]["EJob"],"checked")):?>
                <tr> 
                  <td bgcolor="#F5F5F5" align="right" height="30">직업</td>
                  <td align="center" bgcolor="#F5F5F5" width="9"></td>
                  <td align="center" bgcolor="#CCCCCC" width="1"></td>
                  <td align="center" width="9"></td>
                  <td bgcolor='#FFFFFF'> <select name="job" id="job">
<?
reset($JobArr);
foreach($JobArr as $key=>$value){
$selected = $list["job"] == $key ? "selected":""; 
echo "<option value='$key' $selected>$value</option>\n";
}
?>
                   </select> </td>
                </tr>
                <? endif;?>
                <?if(!strcmp($cfg["mem"]["EScholarship"],"checked")):?>
                <tr> 
                  <td bgcolor="#F5F5F5" align="right" height="30">학력</td>
                  <td align="center" bgcolor="#F5F5F5" width="9"></td>
                  <td align="center" bgcolor="#CCCCCC" width="1"></td>
                  <td align="center" width="9"></td>
                  <td bgcolor='#FFFFFF'> <select name="scholarship" id="scholarship">
<?
reset($ScholarshipArr);
foreach($ScholarshipArr as $key=>$value){
$selected = $list["scholarship"] == $key ? "selected":"";
echo "<option value='$key' $selected>$value</option>\n";
}
?>
                    </select> </td>
                </tr>
                <? endif;?>
                <?if (!strcmp($cfg["mem"]["ECompany"],"checked")):?>
                <tr> 
                  <td bgcolor="#F5F5F5" align="right" height="30">회사명</td>
                  <td align="center" bgcolor="#F5F5F5" width="9"></td>
                  <td align="center" bgcolor="#CCCCCC" width="1"></td>
                  <td align="center" width="9"></td>
                  <td bgcolor='#FFFFFF'> <input name="company" type="text" id="company" style="font: 9pt 굴림; border:1 solid #cccccc" value="<?=$list[company]?>" size="20" maxlength="30" >                  </td>
                </tr>
                <? endif;?>
                <?if(!strcmp($cfg["mem"]["ECompnum"],"checked")):?>
                <tr> 
                  <td bgcolor="#F5F5F5" align="right" height="30">사업자등록번호</td>
                  <td align="center" bgcolor="#F5F5F5" width="9"></td>
                  <td align="center" bgcolor="#CCCCCC" width="1"></td>
                  <td align="center" width="9"></td>
                  <td bgcolor='#FFFFFF'> 
                    <?=$companynum[0]?>
                    - 
                    <?=$companynum[1]?>
                    - 
                    <?=$companynum[2]?>                  </td>
                </tr>
                <? endif;?>
                <tr> 
                  <td bgcolor="#F5F5F5" align="right" height="60">자택주소</td>
                  <td align="center" bgcolor="#F5F5F5" width="9"></td>
                  <td align="center" bgcolor="#CCCCCC" width="1"></td>
                  <td align="center" width="9"></td>
                  <td bgcolor='#FFFFFF'> <input name="zip1_1" type="text" id="zip1_1" style="font: 9pt 굴림; border:1 solid #cccccc;" value="<?=$zip1[0]?>" size="3" maxlength="3" READONLY>
                    - 
                    <input name="zip1_1" type="text" id="zip1_1" style="font: 9pt 굴림; border:1 solid #cccccc;" value="<?=$zip1[1]?>" size="3" maxlength="3" READONLY> 
                    <img src="wizmember/<?=$cfg["skin"]["MemberSkin"]?>/images/but_post.gif" width="91" height="18" align="absmiddle" onClick="javascript:OpenZipcode()" style="cursor:pointer";> 
                    <br> <input name=address1 type=text id="address1" style="font: 9pt 굴림; border:1 solid #cccccc;" value="<?=$list[address1]?>" size=48 READONLY> 
                    <br> <input name=address2 type=text id="address2" style="font: 9pt 굴림; border:1 solid #cccccc;" value="<?=$list[address2]?>" size=48>
                    (상세주소)</td>
                </tr>
                <?if(!strcmp($cfg["mem"]["EAddress3"],"checked")):?>
                <tr> 
                  <td bgcolor="#F5F5F5" align="right" height="60">직장주소</td>
                  <td align="center" bgcolor="#F5F5F5" width="9"></td>
                  <td align="center" bgcolor="#CCCCCC" width="1"></td>
                  <td align="center" width="9"></td>
                  <td bgcolor='#FFFFFF'> <input name="zip2_1" type="text" id="zip2_1" style="font: 9pt 굴림; border:1 solid #cccccc;" value="<?=$zip2[0]?>" size="3" maxlength="3" READONLY>
                    - 
                    <input name="zip2_2" type="text" id="zip2_2" style="font: 9pt 굴림; border:1 solid #cccccc;" value="<?=$zip2[1]?>" size="3" maxlength="3" READONLY> 
                    <img src="wizmember/<?=$cfg["skin"]["MemberSkin"]?>/images/but_post.gif" width="91" height="18" align="absmiddle" onClick="javascript:OpenZipcode1()" style="cursor:pointer";> 
                    <br> <input name=address3 type=text id="address3" style="font: 9pt 굴림; border:1 solid #cccccc;" value="<?=$list[address3]?>" size=48 READONLY> 
                    <br> <input name=address4 type=text id="address4" style="font: 9pt 굴림; border:1 solid #cccccc;" value="<?=$list[address4]?>" size=48>
                    (상세주소)</td>
                </tr>
                <?endif;?>
                <tr> 
                  <td bgcolor="#F5F5F5" align="right" height="25"><font color="#CC3333">*</font> 
                    전화번호</td>
                  <td align="center" bgcolor="#F5F5F5" width="9"></td>
                  <td align="center" bgcolor="#CCCCCC" width="1"></td>
                  <td align="center" width="9"></td>
                  <td bgcolor='#FFFFFF'> <input name=tel1_1 type=text id="tel1_1" style="font: 9pt 굴림; border:1 solid #cccccc;" value="<?=$tel1[0]?>" size=4 maxlength=4 >
                    - 
                    <input name=tel1_2 type=text style="font: 9pt 굴림; border:1 solid #cccccc;" value="<?=$tel1[1]?>" size=4 maxlength=4 >
                    - 
                    <input name=tel1_3 type=text style="font: 9pt 굴림; border:1 solid #cccccc;" value="<?=$tel1[2]?>" size=4 maxlength=4 >                  </td>
                </tr>
                <?if(!strcmp($cfg["mem"]["ETel2"],"checked")):?>
                <tr> 
                  <td bgcolor="#F5F5F5" align="right" height="30">이동전화</td>
                  <td align="center" bgcolor="#F5F5F5" width="9"></td>
                  <td align="center" bgcolor="#CCCCCC" width="1"></td>
                  <td align="center" width="9"></td>
                  <td bgcolor='#FFFFFF'> <input name=tel2_1 type=text style="font: 9pt 굴림; border:1 solid #cccccc;" value="<?=$tel2[0]?>" size=4 maxlength=3 >
                    - 
                    <input name=tel2_2 type=text style="font: 9pt 굴림; border:1 solid #cccccc;" value="<?=$tel2[1]?>" size=4 maxlength=4 >
                    - 
                    <input name=tel2_3 type=text style="font: 9pt 굴림; border:1 solid #cccccc;" value="<?=$tel2[2]?>" size=4 maxlength=4 >                  </td>
                </tr>
                <? endif;?>
                <tr> 
                  <td bgcolor="#F5F5F5" align="right" height="30"><font color="#CC3333">*</font> 
                    전자우편</td>
                  <td align="center" bgcolor="#F5F5F5" width="9"></td>
                  <td align="center" bgcolor="#CCCCCC" width="1"></td>
                  <td align="center" width="9"></td>
                  <td bgcolor='#FFFFFF'><input name=email_1 type=text id="email_1" style="font: 9pt 굴림; border:1 solid #cccccc;" value="<?=$email[0]?>" size=15 >
                    @
                      <input name=email_2 type=text id="email_2" style="font: 9pt 굴림; border:1 solid #cccccc;e" size=15 value="<?=$email[1]?>" />
                    <select name="tmpmail" onChange="email_chk(this)">
                      <option value=''>선택해주세요</option>
<?
reset($MailArr);
foreach($MailArr as $key=>$value){
	if($email[1] == $value) $status = "on";
	$selected = $email[1] == $value ? "selected":"";
	echo "<option value='$value' $selected>$value</option>\n";
}
?>
                      <option value='etc' <? if($status <> "on") echo "selected"; ?>>기타</option>
                    </select></td>
                </tr>
                <?if(!strcmp($cfg["mem"]["EMailReceive"],"checked")):?>
                <tr> 
                  <td bgcolor="#F5F5F5" align="right" height="30">정기소식메일</td>
                  <td align="center" bgcolor="#F5F5F5" width="9"></td>
                  <td align="center" bgcolor="#CCCCCC" width="1"></td>
                  <td align="center" width="9"></td>
                  <td bgcolor='#FFFFFF'> <input name="mailreceive" type="radio" value="1" <?if(!strcmp($list[mailreceive], "1")) echo"checked";?>>
                    수신 
                    <input type="radio" name="mailreceive" value="0" <?if(!strcmp($list[mailreceive], "0")) echo"checked";?>>
                    수신하지 않음</td>
                </tr>
                <? endif;?>
            </table></td>
          </tr>
          <tr> 
            <td bgcolor="#CCccccc" height="3"></td>
          </tr>
        </table></td>
    </tr>
    <tr> 
      <td align="center" height="40"> <table width="154" border="0" cellspacing="0" cellpadding="0">
          <tr> 
            <td width="43"><input type="image" src="wizmember/<?=$cfg["skin"]["MemberSkin"]?>/images/but_ok.gif" width="70" height="29"></td>
            <td>&nbsp;</td>
            <td width="43"><img src="wizmember/<?=$cfg["skin"]["MemberSkin"]?>/images/but_cancle.gif" width="70" height="29" ONCLICK="javascript:history.go(-1)"; style="cursor:pointer"></td>
          </tr>
        </table></td>
    </tr>
    <tr> 
      <td align="center" height="40">&nbsp;</td>
    </tr>
  </form>
</table>