<?
include "./inc.depth1.php";
include "../config/cfg.core.php";
if($smode == "maingameInfo"){
	switch($svice){
		case "1":$s_class[1] = " class='orange'"; break;
		case "2":$s_class[2] = " class='orange'"; break;
		case "3":$s_class[3] = " class='orange'"; break;
		case "4":$s_class[4] = " class='orange'"; break;
		case "5":$s_class[5] = " class='orange'"; break;
		case "6":$s_class[6] = " class='orange'"; break;
		default:$s_class[0] = " class='orange'"; break;
	}
?>
<div class="titLineC">
<ul class='Gminfo'>
    <li class='start'><a href="javascript:getgameinfo()"<?=$s_class[0]?>>전체</a> </li>
    <li><a href="javascript:getgameinfo(4)"<?=$s_class[4]?>>OBT</a></li>
    <li><a href="javascript:getgameinfo(3)"<?=$s_class[3]?>>CBT</a></li>
    <li><a href="javascript:getgameinfo(2)"<?=$s_class[2]?>>개발중</a></li>
    <li><a href="javascript:getgameinfo(5)"<?=$s_class[5]?>>부분유료</a></li>
    <li><a href="javascript:getgameinfo(6)"<?=$s_class[6]?>>정액유료</a></li>
   <!-- <li><a href="javascript:getgameinfo(1)"<?=$s_class[1]?>>준비중</a></li>-->
</ul>
<div class="moreicon"><a href="./gameinfo/game_info_list.htm?ch=gameinfo&s_national=kr&s_servicestatus=<?=$svice?>"><img src="img/common/more_icon.gif" alt="더보기" /></a></div>
</div>	
<!--<div class="txtArea">						
<ul class="categoryA">
    <li><a href="#">[전체]</a></li>
    <li><a href="#">[오베]</a></li>
    <li><a href="#">[클베]</a></li>
    <li><a href="#">[개발]</a></li>
    <li><a href="#">[무료]</a></li>
    <li><a href="#">[개발]</a></li>
</ul>
<div class="infoTxt">게이머와 함께하는 <span class="orange">게임DB</span></div>
</div>-->                 
<div class="gameInfo">
<ul>
<?
$img_path = "../config/uploadfolder/game/";
if($svice) $whereis = " WHERE gi.hiddenflag = 0 and national='kr' and servicestatus=$svice";
else $whereis = " WHERE gi.hiddenflag = 0 and national='kr' and servicestatus <> 1 and servicestatus <> 7";
$sqlstr = "select * from wizgame gi $whereis  order by wdate desc limit 0, 2";  
//echo $sqlstr;
$sqlqry = $dbcon->_query($sqlstr);
$cnt = 0;
while($list = $dbcon->_fetch_array($sqlqry)):
extract($list);
$class = $cnt ? " class='last'":"";
$genrestr = $genreArr[$genre];
$servicestatusstr = $servicestatusArr[$servicestatus];  
// echo "servicestatus:".$servicestatus;
// print_r($servicestatusArr);  
## 총 평점에 관한 처리
$ave = $gamech->get_totaleva_wizgame($list);

//현재 평가 게임 정보 가져오기
$evainfo = $gamech->c_evainfo($uid, $servicestatus);   
?>                 
  <li<?=$class?>>
      <div class="thumImg">
          <img src="<?=$common->getthumbimg($img_path, $img_list, 87, 77) ?>" alt="게임이미지" width="87" height="77" /></div>
        <p class="infotxt">
<?
if($evainfo["sdate"]){//평점이 있으면
?>                                   
            유저평점
            <span class="pointU"><?=number_format($ave["total"], 1)?></span>
            <a href="javascript:gotogameinfoview(<?=$uid?>)"><img src="img/main/btn_point.gif" alt="평점주기" /></a>
            <?
            }else{
            ?>
            유저평점
            <span class="pointUb"><span class='orange'>평점</span>이<br /> 없습니다.</span>
            <a href="javascript:gotogameinfoview(<?=$uid?>)"><img src="img/main/btn_point.gif" alt="평점주기" /></a>
            <?
            }
            ?>
        </p>
        <div class="subjectA"><a href="javascript:gotogameinfoview(<?=$uid?>)" class="black">(<?=$genrestr?>) <span class="b"><?=$subject?></span></a><br />[<?=$servicestatusstr?>]  <? if($evainfo["sdate"]) echo $common->viewdate("y.m.d", $evainfo["sdate"])."-".$common->viewdate("y.m.d", $evainfo["edate"])?></div>
  </li>
<?
$cnt++;
endwhile;
?>                            
</ul>
</div>
<ul class="gameListA">
<?
$sqlstr = "select * from wizgame gi $whereis  order by wdate desc limit 2, 3";  
//echo $sqlstr;
$sqlqry = $dbcon->_query($sqlstr);
$cnt = 0;
while($list = $dbcon->_fetch_array($sqlqry)):
extract($list);
$class = $cnt==2 ? " class='last'":"";
$genrestr = $genreArr[$genre];
$servicestatusstr = $servicestatusArr[$servicestatus];  
// echo "servicestatus:".$servicestatus;
// print_r($servicestatusArr);  
## 총 평점에 관한 처리
$ave = $gamech->get_totaleva_wizgame($list);

//현재 평가 게임 정보 가져오기
$evainfo = $gamech->c_evainfo($uid, $servicestatus);   
?>                    
<li>
    <span class="value01">(<?=$genrestr?>)</span>
    <span class="value02"><a href="javascript:gotogameinfoview(<?=$uid?>)"><?=$subject?></a></span>
    <span class="value03">[<?=$servicestatusstr?>]</span>
    <span class="value04"><? if($evainfo["sdate"]) echo $common->viewdate("y.m.d", $evainfo["sdate"])."~".$common->viewdate("y.m.d", $evainfo["edate"])?></span>
    <span class="value05"><?=number_format($ave["total"], 1)?></span>
</li>
<?
$cnt++;
endwhile;
?>                         
</ul>	
<?
}//if($smode == "maingameInfo"){
else if($smode == "maingamesch"){
#type : svs:서비스 , evt:event
$tabimg[0] = "img/main/btn_d_01.gif";
$tabimg[1] = "img/main/btn_d_02.gif";
switch($type){
	case "svs":$tabimg[0] = "img/main/btn_d_01_on.gif";break;
	case "evt":$tabimg[1] = "img/main/btn_d_02_on.gif";break;
}
?>
					<ul class="tabM">
						<li><a href="javascript:void(0)"><img src="<?=$tabimg[0]?>" alt="게임서비스일정" id="switchtab1" onClick="getgamesch('svs');" /></a></li>
						<li><a href="javascript:void(0)"><img src="<?=$tabimg[1]?>" alt="이벤트일정" id="switchtab2" onClick="getgamesch('evt');" /></a></li>
					</ul>
                    
<div class="boxLine" id="gamenotice_tab1" style="display:block">
						<span class="txtA01">
							<span class="black b">현재시간 <?=date("Y.m.d")?> (<span class='red'><?=$common->getWeekstr(date("w"))?></span>요일)<br />
							</span>
                         
<?
$month = date("m");
$nextmonth = $month + 1;
$cnt = $gamech->getcntSchedule($type, $month);
$cnt1 = $gamech->getcntSchedule($type, $nextmonth);
?>
							<span class="orange b"><?=date("m");?></span>월 일정 : <span class="orange b"><?=$cnt?></span>건 | <span class="orange b"><?=date("m", mktime(0,0,0,date("m")+1, date("d"), date("Y")));?></span>월 일정 : <span class="orange b"><?=$cnt1?></span>건
						</span>
						<p class="imgThum"><? $banner = $common->getbanner(5, 230, 60, null, 1); echo $banner[0];?></p>

<!-- 이전 일정 시작-->  
<?
$cnt_prev = $gamech->getcntSchedule($type, $month, "prev");
##op : null 기간별 일정, now : 현재 일정, prev : 이전일정, next : 다음일정
if($cnt_prev){

?>
<div class="boxPlan01"<? if($cnt_prev >= 1){ echo " onMouseOver=\"ShowPopLayer1('prev_sch_Layer1')\" onMouseOut=\"ClosePopLayer('prev_sch_Layer1')\""; } ?>>
							<span class="date"><?=$common->viewdate("m.d", $gamech->tmpsdate);?></span>
							<span class="subjectT"><?=$common->strCutting($gamech->rtn[0]["subject"], 15)?>(<?=$cnt_prev?>건)</span>

</div>
							<!-- 레이어 -->
							<div id="prev_sch_Layer1" style="display:none; background-color:#FFFFFF; position:absolute; z-index:10; padding:5px 5px 5px 5px;" onMouseOver="ShowPopLayer1('prev_sch_Layer1')" onMouseOut="ClosePopLayer('prev_sch_Layer1')";>
								<ul>
<?
foreach($gamech->rtn as $value){
$cat = $value["cat"];
$dpstr = $common->strCutting("[".$cat."] ".$value["subject"], 20);
?>                     
									<li>
										<span class="subjectL"><a href="javascript:void(0)" onClick="gotogamenews(<?=$value["uid"]?>)"><?=$dpstr?></a></span>
										<span class="orange"><?=$common->viewdate("m.d", $value["sdate"])?> - <?=$common->viewdate("m.d", $value["edate"])?></span>
									</li>
<?
}
?>
								</ul>
							</div>
							<!-- //레이어 -->
<? }else{ ?>
<div class="boxPlan01">
							<span class="date"></span>
							<span class="subjectT">일정이 없습니다.</span>
</div>                            
<? } ?>
<!-- 이전 일정 끝-->  
<!-- 금일 일정 시작--> 
<?
$cnt_now = $gamech->getcntSchedule($type, $month, "now");
?>

                        
						<div class="boxPlan02"<? if($cnt_now >= 1){ echo " onMouseOver=\"ShowPopLayer1('prev_sch_Layer2')\" onMouseOut=\"ClosePopLayer('prev_sch_Layer2')\""; } ?>>
							<span class="date"><span class="orange"><?=date("m")?></span>월<br /><?=date("d")?>일</span>
							<span class="subjectT"><?=$common->strCutting($gamech->rtn[0]["subject"], 15)?>(<?=$cnt_now?>건)
								<span class="txtB">게임일정(총<?=$gamech->totalcnt?>건)</span>
							</span>
						</div>
							<!-- 레이어 -->
							<div id="prev_sch_Layer2" style="display:none; background-color:#FFFFFF; position:absolute; z-index:11;padding:5px 5px 5px 5px;" onMouseOver="ShowPopLayer1('prev_sch_Layer2')" onMouseOut="ClosePopLayer('prev_sch_Layer2')";>
								<ul>
<?
foreach($gamech->rtn as $value){
$cat = $value["cat"];
$dpstr = $common->strCutting("[".$cat."] ".$value["subject"], 20);
?>                     
									<li>
										<span class="subjectL"><a href="javascript:void(0)" onClick="gotogamenews(<?=$value["uid"]?>)"><?=$dpstr?></a></span>
										<span class="orange"><?=$common->viewdate("m.d", $value["sdate"])?> - <?=$common->viewdate("m.d", $value["edate"])?></span>
									</li>
<?
}
?>
								</ul>
							</div>
							<!-- //레이어 -->   
                            
<!-- 금일 일정 끝-->  
<!-- 다음 일정 시작-->                                                  
<?
$cnt_next = $gamech->getcntSchedule($type, $month, "next");
if($cnt_next){
?>                        
						<div class="boxPlan01"<? if($cnt_next >= 1){ echo " onMouseOver=\"ShowPopLayer1('prev_sch_Layer3')\" onMouseOut=\"ClosePopLayer('prev_sch_Layer3')\""; } ?>>
							<span class="date"><?=$common->viewdate("m.d", $gamech->tmpsdate);?></span>
							<span class="subjectT"><?=$common->strCutting($gamech->rtn[0]["subject"], 15)?>(<?=$cnt_next?>건)</span>
						</div>
							<!-- 레이어 -->
							<div id="prev_sch_Layer3" style="display:none; background-color:#FFFFFF; position:absolute; z-index:12; padding:5px 5px 5px 5px;" onMouseOver="ShowPopLayer1('prev_sch_Layer3')" onMouseOut="ClosePopLayer('prev_sch_Layer3')";>
								<ul>
<?
foreach($gamech->rtn as $value){
$cat = $value["cat"];
$dpstr = $common->strCutting("[".$cat."] ".$value["subject"], 20);
?>                     
									<li>
										<span class="subjectL"><a href="javascript:void(0)" onClick="gotogamenews(<?=$value["uid"]?>)"><?=$dpstr?></a></span>
										<span class="orange"><?=$common->viewdate("m.d", $value["sdate"])?> - <?=$common->viewdate("m.d", $value["edate"])?></span>
									</li>
<?
}
?>
								</ul>
							</div>
							<!-- //레이어 -->                        
<?
}else{
?>
						<div class="boxPlan01">
							<span class="date"></span>
							<span class="subjectT">일정이 없습니다.</span>
						</div>
<?
}
?>  
<!-- 다음 일정 끝-->                       
					</div>
<?
}//else if($smode == "maingamesch"){      
?>              