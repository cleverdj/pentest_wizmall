<?
/* 
제작자 : 폰돌
스킨 : wizboard list skin 
URL : http://www.shop-wiz.com
Email : master@shop-wiz.com
*** Updating List ***
*/

/********************************************************************** modify 일경우 현재 게시된 글들을 불러온다 **********/
if(!strcmp($mode,"modify")):
	$sqlstr="SELECT * FROM $tb_name WHERE UID='$board->uid'";//일반적인 UID를 사용할 경우 include 된 파일들과 출돌
	$dbcon->_query($sqlstr, 1);
	$list=$dbcon->_fetch_array();
	$list["SUBJECT"]	= stripslashes($list["SUBJECT"]);
    $list["CONTENTS"] = stripslashes($list["CONTENTS"]);
	$SPARE1			= explode("|", $list["SPARE1"]);
	$UPDIR1			= explode("|", $list["UPDIR1"]);
	$TxtType		= $SPARE1[0];
	$RepleMail		= $SPARE1[1];
	$Secret			= $SPARE1[2];
	$MainDisplay	= $SPARE1[3];
	//$list[CONTENTS] = $common->switchHtmlText($list[CONTENTS], $TxtType); 
	if ($_COOKIE["MODIFY"] != $board->uid."_".$board->bid."_".$board->gid){
		$common->js_location("./wizboard.php?mode=modlogin&BID=$board->bid&GID=$board->gid&nmode=$mode&adminmode=$adminmode&optionmode=$optionmode&UID=$board->uid&cp=$cp&category=$category");
	}
	// 추후 아래와 같이 하여 진행 처리
	//$list = $board->getmodifyview($uid);
		
endif;

/********************************************************************* reply 일경우 SUBJECT에 Re표시를 덧 붙인다. **********/
if(!strcmp($mode,"reply")):
	$sqlstr="SELECT SUBJECT, CONTENTS, SPARE1 FROM $tb_name WHERE UID='$board->uid'";
	$dbcon->_query($sqlstr);
	$list=$dbcon->_fetch_array();
	$list[SUBJECT] = stripslashes($list[SUBJECT]);
    $list[CONTENTS] = stripslashes($list[CONTENTS]);
	$list[CONTENTS] = "\n\r\n\r\n\r\n\r\n\r ------------ [Original Message] --------------------------\r\n&gt;&gt;".str_replace("\n","\n&gt;&gt;",$list[CONTENTS]);
	$list[SUBJECT]="Re: ".$list[SUBJECT];
	// 추후 아래와 같이 하여 진행 처리
	//$list = $board->getreplyview($uid);	
endif;
?>
<div id="WRITE_FORM_TRANSFER_DIV" style="display:none">
작성글을 저장중입니다.
<p>&nbsp;</p>
잠시만 기다려 주시기 바랍니다.
</div>
<div id="WRITE_FORM_DIV" style="display:block">
  <form name="BOARD_WRITE_FORM" action="<?=$PHP_SELF?>" method="post" enctype="multipart/form-data" onsubmit="return board_write_fnc(this);">
    <? if(!$bmode) $bmode="write"; ?>
    <input type="hidden" name="blank" value="">
    <!-- mysql에서 언어가 kr 이 아닌경우 modify시 맨처음 hidden값이 사라지는 알지못할 버그발생땜에 -->
    <input type="hidden" name="BID" value="<?=$BID?>">
    <input type="hidden" name="GID" value="<?=$GID?>">
    <input type="hidden" name="mode" value="<?=$mode?>">
    <input type="hidden" name="bmode" value="<?=$mode;?>">
    <input type="hidden" name="adminmode" value="<?=$adminmode?>">
    <input type="hidden" name="optionmode" value="<?=$optionmode?>">
    <input type="hidden" name="UID" value="<?=$UID;?>">
    <input type="hidden" name="CATEGORY" value="<?=$category?>">
    <input type="hidden" name="ID" value="<?=$cfg["member"]["mid"];?>">
    <input type="hidden" name="spamfree" value="">
    <table width="100%" border="0" cellspacing="1" cellpadding="5">
      <tr>
        <td width="100" height="27" align="center" bgcolor="#EBEBEB"><font  style="font-family: '굴림', '돋움','Arial';font-size: 12px; line-height:140%">이 
          름</font></td>
        <td height="27"><input type="text" name="NAME" size="15" value="<? if($list[NAME]) echo "$list[NAME]"; else echo $cfg["member"]["mname"];?>" checkenable msg="이름을 입력하세요" autocomplete="off" />
        </td>
        <td width="100" height="27" align="center" bgcolor="#EBEBEB"><font color="<?=$Fontcolort?>"  style="font-family: '굴림', '돋움','Arial';font-size: 12px; line-height:140%">비밀번호</font></td>
        <td height="27"><input type="password" name="PASSWD" size="15" value="<? echo $list["PASSWD"]; ?>" checkenable msg="비밀번호를 입력하세요" autocomplete="off" />
        </td>
      </tr>
      <tr>
        <td width="100" align="center" bgcolor="#EBEBEB"><font  style="font-family: '굴림', '돋움','Arial';font-size: 12px; line-height:140%">전자메일</font></td>
        <td colspan="3"><input type="text" name="EMAIL" size="40" value="<? if($list[EMAIL]) echo "$list[EMAIL]"; else echo $cfg["member"]["mmail"];?>" autocomplete="off" />
        </td>
      </tr>
      <? 
if($cfg["wizboard"]["CategoryEnable"]):
?>
      <tr>
        <td width="100" align="center" bgcolor="#EBEBEB"><font  style="font-family: '굴림', '돋움','Arial';font-size: 12px; line-height:140%">종류</font></td>
        <td colspan="3"><?=$board->getselectcategory($list["CATEGORY"])?>
        </td>
      </tr>
      <? endif; ?>
      <tr>
        <td width="100" align="center" bgcolor="#EBEBEB"><font  style="font-family: '굴림', '돋움','Arial';font-size: 12px; line-height:140%">제 
          목</font></td>
        <td colspan="3"><input type="text" name="SUBJECT" size="40" value="<?=$list[SUBJECT];?>" checkenable msg="제목을 입력하세요" autocomplete="off" />
          <input type=checkbox value="1" name="Secret"<? if($Secret) echo " checked";?>>
          비밀 게시물
          <?
//echo $_COOKIE[BOARD_PASS].",".$_COOKIE[ROOT_PASS];		  
if($_COOKIE[BOARD_PASS] || $_COOKIE[ROOT_PASS]):
?>
          <input type=checkbox value="1" name="MainDisplay"<? if($MainDisplay) echo " checked";?>>
          공지글
          <?
endif;
?>
          <input name="tb_url_enable" type=checkbox id="tb_url_enable" value="1" onclick="tb_box(this)">
          엮인글(트랙백)</td>
      </tr>
      <tr id="tb_url_box" style="display:none">
        <td width="100" align="center" bgcolor="#EBEBEB"><font  style="font-family: '굴림', '돋움','Arial';font-size: 12px; line-height:140%">엮인글URL</font></td>
        <td colspan="3"><input type="text" name="tb_url" size="40"></td>
      </tr>
<?     
if($cfg["wizboard"]["editorenable"] == "1"){   
echo "<input type='hidden' name='TxtType' value='1'>";
}else{
?>    
      <tr>
        <td width="100" align="center" bgcolor="#EBEBEB"><font  style="font-family: '굴림', '돋움','Arial';font-size: 12px; line-height:140%">텍스트타입</font></td>
        <td colspan="3">
                <input type="radio" name="TxtType" value="0" <? if(!$TxtType) ECHO "CHECKED";?>> Text <input type="radio" name="TxtType" value="1" <? if(!strcmp($TxtType,"1")) ECHO "CHECKED";?>> Html</font> </td>
      </tr>
<?
}
?>      
      <tr>
        <td width="100" align="center" bgcolor="#EBEBEB"><font  style="font-family: '굴림', '돋움','Arial';font-size: 12px; line-height:140%">내 
          용</font></td>
        <td colspan="3">
<textarea name="CONTENTS" rows="15" style="width:100%;" id="CONTENTS" checkenable msg="내용을 입력하세요"><?=$list[CONTENTS];?></textarea>

        </td>
      </tr>
      <?
		for($i=0; $i<$cfg["wizboard"]["ATTACHEDCOUNT"]; $i++){
		?>
      <tr>
        <td width="100" align="center" bgcolor="#EBEBEB"><font  style="font-family: '굴림', '돋움','Arial';font-size: 12px; line-height:140%">첨부화일</font></td>
        <td colspan="3"><input type="file" name="file[<?=$i;?>]">
          <? if($mode == "modify" && $UPDIR1[$i]) echo $common->getImgName($UPDIR1[$i])." <input name='file_del[$i]' type='checkbox' value='1'>파일삭제"; ?>
        </td>
      </tr>
      <tr  height="1">
        <td height="1" colspan="7" align="center" bgcolor="#CCCCCC"></td>
      </tr>      
      <?
	   }
	  ?>
    </table>
    <div id="iconbox" style="text-align:center"><? echo $board->showBoardIcon('save');?> <? echo $board->showBoardIcon('cancel');?> </div>
  </form>
</div>
