<?php
/**
* 하단 프레임
*
* @filename : main/bottom.php
* @version  : v 1.0 2002.11.06 17:40
* @author   : nsl <smpoem@magicn.com>
*/

$_SKYDIR_URL = '../';

// 기본 설정 초기화
include '../common/skydir_init.php';

// 오른쪽 프레임 reload 유부
$isRightFrameReload  = false;


// 환경설정 저장 유무
$isConfig = false;

$isConfig = false;
if (!empty($windowsWidth) && $windowsWidth >= $rcfg->minWindowsWidth) {

    $ucfg->windowsWidth = $windowsWidth;
    $isConfig = true;
}

if (!empty($windowsHeight) && $windowsHeight >= $rcfg->minWindowsHeight) {

    $ucfg->windowsHeight = $windowsHeight;
    $isConfig = true;
}

// 오른쪽 프레임 크기에 변화가 있다면
if (!empty($rfw) || !empty($rfh)) {
    
    // 오른쪽 프레임 크기
    $ucfg->rightFrameWidth  = $rfw;
    $ucfg->rightFrameHeight = $rfh;
    $isConfig = true;

    $isRightFrameReload = true;
}

// 이미지 모드
if ($imgmode == 'reset') {

    if ($rcfg->isImageMode)
        $ucfg->isImageMode = false;
    else
        $ucfg->isImageMode = true;    
    
    $isConfig = true;

    $isRightFrameReload = true;
}

if ($isConfig) {

    setConfigFile($dcfg->uconfigFile, $ucfg);
}

include (HEADER_FILE);
?>
<script language="javascript">
<!--

    function setConfigSave() {

        var width  = getParentClientWidth();
        var height = getParentClientHeight();
        var rightFrameWidth = getClientWidthRight() - 40;
        var rightFrameHeight = getClientHeightRight() - 60;

        location.replace('<?=$_SERVER[PHP_SELF]?>' + '?windowsWidth=' + width + '&windowsHeight=' + height + 
                         '&rfw=' + rightFrameWidth + '&rfh=' + rightFrameHeight);
    }


    /**
    * 파일올리 창
    *
    * @param  string  code : 코드
    * @param  integer winWidth  : 원도우 width
    * @param  integer winHegith : 원도우 height
    */
    function fileWin(code, width, height) {

        // 기본 크기 설정
        if (width == -1)  width = 500;
        if (height == -1) height = 480;

        // center 위치 설정
        var left = sky.getCenterPosLeft(width);
        var top  = sky.getCenterPosTop(height);

        // 현재 경로 - right 프레임에서 얻음
        var cd =  parent.top.right.layerCode.cd.value;

        var option = 'width=' + width + ', height=' + height + ', left=' + left + ', top=' + top;
        winName = window.open('../php/file_win.php?wmode=nwin&code=' + code + '&cd=' + cd, '' , option);
        winName.focus();

        return;

    } // configWin() End

    <?  // 오른쪽 프레임 출력 모드가 바뀌었으면 reload
        if ($isRightFrameReload) {
    ?>
        top.right.location.reload();
    <? } ?>

    <?
    if ($install == "first") {
    ?>
        setConfigSave();
    <? } ?>
//-->
</script>
<body leftmargin="0" topmargin="0" marginwidth="0" marginheight="0" <?=$dcfg->body?> OnResize="setConfigSave()">
<table border=0 width=100% cellpadding=2 cellspacing=0>
<tr>
  <td></td>
  <td></td>
  <td width=120>
    <input type=button style="height:35px; width=120px; font-weight:bold" value=" <?=$lg->dirMakeTitle?> " OnClick="fileWin('file_dir', -1, -1)">
  </td>
  <td width=120>
    <input type=button style="height:35px; width=120px; font-weight:bold" value=" <?=$lg->fileUpTitle?> "  OnClick="fileWin('file_fileup', -1, -1)">
  </td>
</body>
</html>