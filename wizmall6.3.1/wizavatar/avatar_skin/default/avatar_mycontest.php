<SCRIPT LANGUAGE="JavaScript">
var tmp;

function showmenu(no,date,memo,ValueShow) 
{
  var rightedge = document.body.clientWidth-event.clientX;
  var bottomedge = document.body.clientHeight-event.clientY;

  if (rightedge < mymenu.offsetWidth)
      mymenu.style.left = document.body.scrollLeft + event.clientX - mymenu.offsetWidth;
  else
      mymenu.style.left = document.body.scrollLeft + event.clientX;

  if (bottomedge < mymenu.offsetHeight)
      mymenu.style.top = document.body.scrollTop + event.clientY - mymenu.offsetHeight;
  else
      mymenu.style.top = document.body.scrollTop + event.clientY;
  mymenu.style.visibility = ValueShow;

  tmp = "<table width='130' border='0' cellspacing='1' cellpadding='0' bgcolor='#888888' style='table-layout:fixed;'><tr bgcolor='#FFFFFF'><td><table border='0' cellpadding='1' cellspacing='0' width='100%' onclick=showmenu('','','','hidden')><tr onMouseOver=this.style.backgroundColor='#E6E6FA' onMouseOut=this.style.backgroundColor=''><td align='left' height='20'>&nbsp;<a href=\"javascript:void(NewWindow('avatar_album_ye.php?winmode=info&mode=member&no="+no+"&date="+date+"&memo="+memo+"";
<?if($class == "minishot") {?>tmp = tmp+"&class=minishot";<?}?>
  tmp = tmp+"','avatar_album_foot','400','420','yes'))\" onMouseOver=\"window.status=('꼬리말 보기'); return true;\">꼬리말 보기</a></td></tr><tr onMouseOver=this.style.backgroundColor='#E6E6FA' onMouseOut=this.style.backgroundColor=''><td align='left' height='20'>&nbsp;<a href=\"javascript:void(NewWindow('avatar_album_ye.php?winmode=info&mode=me&no="+no+"&date="+date+"&memo="+memo+"";
<?if($class == "minishot") {?>tmp = tmp+"&class=minishot";<?}?>
  tmp = tmp+"','avatar_album_info','350','380','no'))\" onMouseOver=\"window.status=('상세 정보 보기'); return true;\">상세 정보 보기</a></td></tr>";
<?if($class != "minishot") {?>
  tmp = tmp+"<tr onMouseOver=this.style.backgroundColor='#E6E6FA' onMouseOut=this.style.backgroundColor=''><td align='left' height='20' title='이 사진의 아이템으로 교체합니다'>&nbsp;<a href=\"./avatar_album_ye.php?winmode=ok&mode=change&no="+no+"\" onMouseOver=\"window.status=('현재모습으로 저장'); return true;\">현재모습으로 저장</a></td></tr>";
<?if($use_contest == "Y") {?>
  tmp = tmp+"<tr onMouseOver=this.style.backgroundColor='#E6E6FA' onMouseOut=this.style.backgroundColor=''><td align='left' height='20' title='컨테스트 참가하기'>&nbsp;<a href=\"javascript:NewWindow('./avatar_album_ye.php?winmode=ok&mode=contest&no="+no+"', 'contest', '10','10','no')\" onMouseOver=\"window.status=('컨테스트 참가하기'); return true;\">컨테스트 참가</a></td></tr>";
<?} }?>
  tmp = tmp+"</table></td></tr></table>";

  document.all.mymenu.innerHTML = tmp;
}

function hidemenu()
{
  if (mymenu.style.visibility == "visible")
      mymenu.style.visibility = "hidden";
}

function NewWindow(mypage, myname, w, h, scroll) 
{ 
  var winl = (screen.width - w) / 2; 
  var wint = (screen.height - h) / 2; 
  winprops = 'height='+h+',width='+w+',top='+wint+',left='+winl+',scrollbars='+scroll+',resizable' 
  win = window.open(mypage, myname, winprops) 
  if (parseInt(navigator.appVersion) >= 4) { win.window.focus(); } 
}

function confirm_del(no){
	if(confirm('콘테스트에 등록된 데이타까지 삭제됩니다.\n\n정말로 삭제하시겠습니까?')){
		location.href="./wizavatar/avatarProc.php?mode=contestdel&no="+no;
	}
}
</script>
<? include ($avatar_skin_path."/topbanner.php");?>
<!-- 아바타 체험 메뉴 시작 부분-->
<? include ($avatar_skin_path."/topnavy.php");?>
<!---서브메뉴 테아블 끝---->
<table width="678" border="0" cellspacing="0" cellpadding="0">
  <tr>
    <td colspan="3">&nbsp;</td>
  </tr>
  <tr>
    <td colspan="3"><img src="<?=$avatar_skin_path?>/images/avata_con_17.gif" width="678" height="40" /></td>
  </tr>
  <tr>
    <td width="7" bgcolor="e9e4e0">&nbsp;</td>
    <td width="663"><table width="98%" border="0" align="center" cellpadding="0" cellspacing="0">
        <tr>
          <td><table width="599" border="0" align="center" cellpadding="0" cellspacing="0">
        <tr>
          <?
$ListNo=$pg_counts?$pg_counts:6;
$PageNo = 10;

$whereis = " where user_id = '".$avatar->avatar_userid."' and contest = 1";

/* 총 갯수 구하기 */

$TOTAL_STR = "select count(no) from ".$WIZTABLE["AVATARALBUM"]." $whereis ";
//echo "\$TOTAL_STR = $TOTAL_STR <br>";
$TOTAL_QRY = mysql_query($TOTAL_STR) or die(mysql_error()."<br>".$TOTAL_STR);
$TOTAL = @mysql_result($TOTAL_QRY, 0, 0);
mysql_free_result($TOTAL_QRY);

if(empty($CP) || $CP <= 0) $CP = 1;

//--페이지 나타내기--
/* 하단 페이지수 표시 for ($i = $SP; $i <= $EP && $i <= $TP ; $i++) */
$TP = ceil($TOTAL / $ListNo) ; /* 총페이지수(Total Page) : 총게시물수 / 페이지당 리스트수  */
$CB = ceil($CP / $PageNo); /* 현재블록(Current Block) : 현재페이지 / 표시되는 페이지 수 */
$SP = ($CB - 1) * $PageNo + 1; /* 블록의 처음 페이지(Start Page) 구하기 */
$EP = ($CB * $PageNo); /*블록의 마지막 페이지(End Page) : 현재 블록 * 표시되는 페이지수 */
$TB = ceil($TP / $PageNo); /* 총블록수(Total Block) : 총페이지수 / 표시되는 페이지 수 */

$START_NO = ($CP - 1) * $ListNo;
$BOARD_NO1=$TOTAL-($ListNo*($CP-1));
$sqlstr = "select no,user_id,date,memo from ".$WIZTABLE["AVATARALBUM"]." $whereis order by date desc limit $START_NO, $ListNo";
$sqlqry = mysql_query($sqlstr) or die($sqlstr."<br>".mysql_error());

//echo "sqlstr = $sqlstr <br>";
$cnt=0;
while($list=@mysql_fetch_array($sqlqry)):
      $check++;
      $memo= str_replace("\r\n","&nbsp;",$list[memo]);
	  $avatar->mode = "photo";
	  $photo_view = $avatar->show_avatar($list[no]);

  $check++;
?>
          <td width="199" align="center" valign="top"><table width="140" border="0" align="center" cellpadding="0" cellspacing="1">
              <tr>
                <td align="center"><?=$photo_view?></td>
              </tr>
            </table>
            <table width="180" border="0" align="center" cellpadding="3" cellspacing="0">
              <tr>
                <td align="center"><? echo date("Y-m-d H:i:s",$list[date]);?></td>
              </tr>
              <tr>
                <td align="center"><?=$memo?></td>
              </tr>
              <tr>
                <td align="center"></a> <a href="javascript:confirm_del(<?=$list[no]?>)" onFocus="this.blur()"><img src="./<?=$avatar_skin_path?>/img/my_img06.gif" alt="삭제" width="42" height="19" border="0"></a></td>
              </tr>
            </table></td>
          <?
	$cnt++;
	if(!($cnt%3)){
		echo "</tr>
</table>
<P style='MARGIN-TOP: 20px'> 
<table width='599' border='0' align='center' cellpadding='0' cellspacing='0'>
<tr> ";
	}//else echo "<td width='4'>&nbsp;</td>";

endwhile;
	$tmpcnt = $cnt%3;
	if($tmpcnt){
		for($i=$tmpcnt; $i<3; $i++){
			echo "<td width='199' align='center'>&nbsp;</td>";
		}
	}
?>
        </tr>
      </table></td>
        </tr>
      </table><table width="622" border="0" align="center" cellpadding="0" cellspacing="0">
  <tr>
    <td width="599" height="70" align="center"><?
/* 페이지 번호 리스트 부분 */
/* PREVIOUS or First 부분 */
$TransData = "skinmode=$skinmode&code=$code&c_gender=$c_gender";	
if ( $CB > 1 ) {
$PREV_PAGE = $SP - 1;
echo " <a href='$PHP_SELF?CP=$PREV_PAGE&$TransData'><img src='$avatar_skin_path/images/pre.gif' border='0'></a> ";
} else {
echo " <img src='$avatar_skin_path/images/pre.gif' border='0'> ";
 }


/* LISTING NUMBER PART */
for ($i = $SP; $i <= $EP && $i <= $TP ; $i++) {
if($CP == $i){$NUMBER_SHAPE= "<B>${i}</B>";}
else $NUMBER_SHAPE=${i};
ECHO" <A HREF='$PHP_SELF?CP=$i&$TransData'>$NUMBER_SHAPE</a> ";
}

/* NEXT or END PART */
if ($CB < $TB) {
$NEXT_PAGE = $EP + 1;
ECHO " <a href='$PHP_SELF?CP=$NEXT_PAGE&$TransData'><img src='$avatar_skin_path/images/next.gif' border='0'></a> ";
} else {
ECHO" <img src='$avatar_skin_path/images/next.gif' border='0'> ";
}
?></td>
  </tr>
</table></td>
    <td width="8" bgcolor="e9e4e0">&nbsp;</td>
  </tr>
  <tr>
    <td colspan="3"><img src="<?=$avatar_skin_path?>/images/avata_img02.gif" width="678" height="28"></td>
  </tr>
</table>
