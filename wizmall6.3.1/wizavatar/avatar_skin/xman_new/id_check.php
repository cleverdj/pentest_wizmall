<?
include_once "../../../config/db_info.php";

include_once "../../../config/avatar_config.php"; 

$keyword=stripslashes($keyword);
$keyword=str_replace("`","",$keyword);
$keyword=str_replace("\"","",$keyword);
$keyword=str_replace("'","",$keyword);
$keyword=str_replace(".","",$keyword);
$keyword=str_replace("<","",$keyword);
$keyword=str_replace(">","",$keyword);
$whereis = "where 1";
if($keyword){
	$whereis .= " and userid like '%$keyword%'";
}

switch ($WIZTABLE["AVATARMEMBER"]){
	case "MemberInfo"://	
		$sqlstr = "select * from ".$WIZTABLE["AVATARMEMBER"]." $whereis ";
		//echo $sqlstr;
		$sqlqry = mysql_query($sqlstr) or die(mysql_error()."<br>".$sqlstr);
		$TOTAL = mysql_num_rows($sqlqry);
	break;
	default:##wizMembers//나중에 처리

	break;	
}


$ListNo=$pg_counts?$pg_counts:10;
$PageNo = 10;

if(empty($CP) || $CP <= 0) $CP = 1;

//--페이지 나타내기--
/* 하단 페이지수 표시 for ($i = $SP; $i <= $EP && $i <= $TP ; $i++) */
$TP = ceil($TOTAL / $ListNo) ; /* 총페이지수(Total Page) : 총게시물수 / 페이지당 리스트수  */
$CB = ceil($CP / $PageNo); /* 현재블록(Current Block) : 현재페이지 / 표시되는 페이지 수 */
$SP = ($CB - 1) * $PageNo + 1; /* 블록의 처음 페이지(Start Page) 구하기 */
$EP = ($CB * $PageNo); /*블록의 마지막 페이지(End Page) : 현재 블록 * 표시되는 페이지수 */
$TB = ceil($TP / $PageNo); /* 총블록수(Total Block) : 총페이지수 / 표시되는 페이지 수 */

$START_NO = ($CP - 1) * $ListNo;
$BOARD_NO1=$TOTAL-($ListNo*($CP-1));
?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=<?=$cfg["common"]["lan"]?>" />
<title>아이템 선물하기</title>
<link rel="stylesheet" href="./style.css" type="text/css">
<script language="javascript">
<!--
function CheckStr(strOriginal, strFind, strChange){
   var position, strOri_Length;
   position = strOriginal.indexOf(strFind);

   while (position != -1){
     strOriginal = strOriginal.replace(strFind, strChange);
     position = strOriginal.indexOf(strFind);
  }

  strOri_Length = strOriginal.length;
  return strOri_Length;
}

function returnvalue(id) {
  var f = opener.document.PresentForm;
   f.keyword.value = id;
  // alert(returnvalue)
 	self.close();
}


function findCheck()
{
  if (CheckStr(search_member.keyword.value, " ", "")<3)
  {
     alert("검색어를 3자이상 기입해 주세요");
     search_member.keyword.value= "";
     search_member.keyword.focus();
     return false;
   }
   return true;
}
//-->
</script>
</head>
<body leftmargin="0" topmargin="0">
<table width="360" border="0" cellspacing="0" cellpadding="0">

  <tr>
    <td height="42"  bgcolor="DCF8F8">&nbsp;☆<strong><font color="#6666FF"> 선물할 분 아이디를 선택하세요 </font></strong>☆</td>
  </tr>
  <tr>
    <td align="center"><table width="340" border="0" cellpadding="0" cellspacing="0">
        <tr>
          <td height="1" colspan="3" bgcolor="6ADFDF"></td>
        </tr>
        <tr>
          <td width="1" bgcolor="6ADFDF"></td>
          <td align="center" valign="top"><table width="90%" border="0" cellspacing="0" cellpadding="0">
              <tr>
                <td align="right">총 <font color=red style="font-family:Tahoma;font-size:9pt;">
                  <?=$TOTAL?>
                  </font> 명</td>
              </tr>
            </table>
            <table width="90%" border="0" cellspacing="0" cellpadding="0">
              <tr>
                <td align="center" width="60" height="20" bgcolor="DCF8F8"><strong><font color="#0099CC">번호</font></strong></td>
                <td align="center" width="110"  bgcolor="DCF8F8"><strong><font color="#0099CC">ID</font></strong></td>
                <td align="center" width="110"  bgcolor="DCF8F8"><strong><font color="#0099CC">이름</font></strong></td>
              </tr>
              <form method="post" name="friinfo">
          <?
$cnt=0;	

	switch ($WIZTABLE["AVATARMEMBER"]){
		case "MemberInfo"://	
			$sqlstr = "select * from ".$WIZTABLE["AVATARMEMBER"]." $whereis limit $START_NO, $ListNo";
			$sqlqry = mysql_query($sqlstr) or die(mysql_error()."<br>".$sqlstr);
		break;
		default:##wizMembers//나중에 처리
	
		break;	
	}  
	
	while($list=mysql_fetch_array($sqlqry)){
	  // 아이템 중복 체크 및 성별체크(추후 프로그램 필요)
		switch ($WIZTABLE["AVATARMEMBER"]){
			case "MemberInfo"://	
				$user_id = $list["userid"];
				$user_name = $list["namekr"];
			break;
			default:##wizMembers//나중에 처리
		
			break;	
		}  

?>			  
                <tr align="center" height="20" onMouseOver="this.style.backgroundColor='#E6E6FA'" onMouseOut="this.style.backgroundColor=''">
                  <td style="font-family:Tahoma;font-size:7pt;"><?=$BOARD_NO1?></td>
                  <td class="userid"><a href="#" onClick='javascript:returnvalue("<?=$user_id?>")'> 
                    <?=$user_id?>

                    </a></td>
                  <td><?=$user_name?></td>
                </tr>
<?
	$cnt++;
	$BOARD_NO1--;
	}

if(!$cnt){
?>
                <tr align="center" height="20" onMouseOver="this.style.backgroundColor='#E6E6FA'" onMouseOut="this.style.backgroundColor=''">
                  <td colspan="3">검색된 친구가 없습니다. </td>
                </tr>
<?
}
?>				
              </form>
            </table>
            <table width="90%" border="0" cellspacing="0" cellpadding="0">
              <tr>
                <td align="center"><?
/* 페이지 번호 리스트 부분 */
/* PREVIOUS or First 부분 */
$TransData = "item=$item&page=$next&search=$search&keyword=$keyword&keykind=$keykind";	
if ( $CB > 1 ) {
$PREV_PAGE = $SP - 1;
echo " <a href='$PHP_SELF?CP=$PREV_PAGE&$TransData'>Prev</a> ";
} else {
echo " Prev ";
 }


/* LISTING NUMBER PART */
for ($i = $SP; $i <= $EP && $i <= $TP ; $i++) {
if($CP == $i){$NUMBER_SHAPE= "<B>${i}</B>";}
else $NUMBER_SHAPE=${i};
ECHO" <A HREF='$PHP_SELF?CP=$i&$TransData'>$NUMBER_SHAPE</a> ";
}

/* NEXT or END PART */
if ($CB < $TB) {
$NEXT_PAGE = $EP + 1;
ECHO " <a href='$PHP_SELF?CP=$NEXT_PAGE&$TransData'>Next</a> ";
} else {
ECHO" Next ";
}
?></td>
              </tr>
            </table></td>
          <td width="1" bgcolor="6ADFDF"></td>
        </tr>
        <tr>
          <td height="1" colspan="3" bgcolor="6ADFDF"></td>
        </tr>
      </table>
      <table width="100%" border="0" cellspacing="5" cellpadding="0">
	          <form name="search_member" method="post">
          <input type="hidden" name="search" value="on">
          <input type="hidden" name="val" value="<?=$val?>">
        <tr>
          <td align="center"><select name="keykind" onChange="select_change(this.options[this.selectedIndex].value)" class="memo">
                <option value="name" <?if($keykind=="name")echo "selected";?>>이름</option>
                <option value="user_id" <?if($keykind=="user_id")echo "selected";?>>아이디</option>
                <option value="all">모두</option>
              </select>
              <input type="text" name="keyword" value="<?echo $keyword;?>" onKeyPress="if(event.keyCode==13) return findCheck();">
              &nbsp;<a href="javascript:document.search_member.submit();" onClick="JavaScript:return findCheck();" style="cursor:hand;"><img src="images/btn_search1.gif" width="54" height="25" border="0" align="absmiddle" /></a></td>
        </tr></form>
    </table></td>
  </tr>
</table>
</body>
</html>
