<?
include "../../../config/db_info.php";
include "../../../config/db_connect.php"; 
include "../../../config/avatar_config.php"; 
?>
<HTML>
<HEAD>
<TITLE>친구 찾기</TITLE>
<meta http-equiv="Content-Type" content="text/html; charset=<?=$cfg["common"]["lan"]?>">
<link rel="stylesheet" href="avatar.css" type="text/css">
<script language="JavaScript" src="./id_tooltip.js"></script>
<script language="javascript">
function CheckStr(strOriginal, strFind, strChange){
   var position, strOri_Length;
   position = strOriginal.indexOf(strFind);

   while (position != -1){
     strOriginal = strOriginal.replace(strFind, strChange);
     position = strOriginal.indexOf(strFind);
  }

  strOri_Length = strOriginal.length;
  return strOri_Length;
}

function returnvalue(id) {
  var f = opener.document.PresentForm;
   f.keyword.value = id;
  // alert(returnvalue)
 	self.close();
}


function findCheck()
{
  if (CheckStr(search_member.keyword.value, " ", "")==0)
  {
     alert("검색어를 기입해 주세요");
     search_member.keyword.value= "";
     search_member.keyword.focus();
     return false;
   }
   return true;
}
</script>
<?
$keyword=stripslashes($keyword);
$keyword=str_replace("`","",$keyword);
$keyword=str_replace("\"","",$keyword);
$keyword=str_replace("'","",$keyword);
$keyword=str_replace(".","",$keyword);
$keyword=str_replace("<","",$keyword);
$keyword=str_replace(">","",$keyword);
$whereis = "where 1";
if($keyword){
	$whereis .= " and userid like '%$keyword%'";
}

switch ($WIZTABLE["AVATARMEMBER"]){
	case "MemberInfo"://	
		$sqlstr = "select * from ".$WIZTABLE["AVATARMEMBER"]." $whereis ";
		echo $sqlstr;
		$sqlqry = mysql_query($sqlstr) or die(mysql_error()."<br>".$sqlstr);
		$TOTAL = mysql_num_rows($sqlqry);
	break;
	default:##wizMembers//나중에 처리

	break;	
}


$ListNo=$pg_counts?$pg_counts:10;
$PageNo = 10;

if(empty($CP) || $CP <= 0) $CP = 1;

//--페이지 나타내기--
/* 하단 페이지수 표시 for ($i = $SP; $i <= $EP && $i <= $TP ; $i++) */
$TP = ceil($TOTAL / $ListNo) ; /* 총페이지수(Total Page) : 총게시물수 / 페이지당 리스트수  */
$CB = ceil($CP / $PageNo); /* 현재블록(Current Block) : 현재페이지 / 표시되는 페이지 수 */
$SP = ($CB - 1) * $PageNo + 1; /* 블록의 처음 페이지(Start Page) 구하기 */
$EP = ($CB * $PageNo); /*블록의 마지막 페이지(End Page) : 현재 블록 * 표시되는 페이지수 */
$TB = ceil($TP / $PageNo); /* 총블록수(Total Block) : 총페이지수 / 표시되는 페이지 수 */

$START_NO = ($CP - 1) * $ListNo;
$BOARD_NO1=$TOTAL-($ListNo*($CP-1));
?>
<STYLE type="text/css">
BODY,input,DIV,form,TEXTAREA,center,option,pre,blockquote {font-size:8pt;color:000000;font-family:verdana,굴림;} 
TD {font-size:9pt;color:#666666;font-family:돋움,verdana;line-height:150%}
a { text-decoration: none; color: #CC0000; font-weight: bold;}
a:hover { text-decoration: none; color: #000000; font-weight: bold;}
.page { font-family: "Tahoma", "돋움"; color: #888888; text-decoration: none; font-size: 8pt; line-height: 13pt; }
.page a { font-family: "Tahoma", "돋움"; color: #888888; text-decoration: none; font-size: 8pt; line-height: 13pt; }
.page a:hover { font-family: "Tahoma", "돋움"; color: orange; text-decoration: none; font-size: 8pt; line-height: 13pt; }
.date { font-family: "Tahoma", "돋움"; color: black; text-decoration: none; font-size: 8pt; line-height: 13pt; }
.memo { font-family: "돋움"; color: black; text-decoration: none; font-size: 9pt; line-height: 13pt; }
.userid { font-family: "Tahoma"; color: black; text-decoration: none; font-size: 8pt; line-height: 13pt; }
.userid a:hover { font-family: "Tahoma"; color: orange; text-decoration: none; font-size: 8pt; line-height: 13pt; font-weight: bold;}
</STYLE>
</HEAD>
<body leftmargin="0" topmargin="0" marginwidth="0" marginheight="0">
<table width="100%" border="0" cellspacing="0" cellpadding="0">
        <tr>
          <td width="290" height="30" colspan="5" align="center" bgcolor="#EEEEEE" style="font-family:돋움;font-size:9pt;font-weight:bold;color: black;"> ※ 선물할 친구의 아이디를 선택하세요 </td>
        </tr>
        <tr>
          <td height="12" colspan="5" align="center"><table width="90%" border="0" cellspacing="0" cellpadding="0">
              <tr>
                <td align="right">총 <font color=red style="font-family:Tahoma;font-size:9pt;">
                  <?=$TOTAL?>
                  </font> 명</td>
              </tr>
            </table>
            <table width="90%" border="0" cellspacing="0" cellpadding="0">
              <tr>
                <td align="center" width="60" height="20" style="font-family:Tahoma;font-size:8pt;font-weight:bold;" bgcolor="#BABABA">번호</td>
                <td align="center" width="110" style="font-family:Tahoma;font-size:8pt;font-weight:bold;" bgcolor="#BABABA">ID</td>
                <td align="center" width="110" style="font-family:Tahoma;font-size:8pt;font-weight:bold;" bgcolor="#BABABA">이름</td>
              </tr>
              <form method="post" name="friinfo">
          <?
$cnt=0;	

	switch ($WIZTABLE["AVATARMEMBER"]){
		case "MemberInfo"://	
			$sqlstr = "select * from ".$WIZTABLE["AVATARMEMBER"]." $whereis limit $START_NO, $ListNo";
			$sqlqry = mysql_query($sqlstr) or die(mysql_error()."<br>".$sqlstr);
		break;
		default:##wizMembers//나중에 처리
	
		break;	
	}  
	
	while($list=mysql_fetch_array($sqlqry)){
	  // 아이템 중복 체크 및 성별체크(추후 프로그램 필요)
		switch ($WIZTABLE["AVATARMEMBER"]){
			case "MemberInfo"://	
				$user_id = $list["userid"];
				$user_name = $list["namekr"];
			break;
			default:##wizMembers//나중에 처리
		
			break;	
		}  

?>			  
                <tr align="center" height="20" onMouseOver="this.style.backgroundColor='#E6E6FA'" onMouseOut="this.style.backgroundColor=''">
                  <td style="font-family:Tahoma;font-size:7pt;"><?=$BOARD_NO1?></td>
                  <td class="userid"><a href="#" onClick='javascript:returnvalue("<?=$user_id?>")'> 
                    <?=$user_id?>

                    </a></td>
                  <td><?=$user_name?></td>
                </tr>
<?
	$cnt++;
	$BOARD_NO1--;
	}

if(!$cnt){
?>
                <tr align="center" height="20" onMouseOver="this.style.backgroundColor='#E6E6FA'" onMouseOut="this.style.backgroundColor=''">
                  <td colspan="3" style="font-family:Tahoma;font-size:7pt;">검색된 친구가 없습니다. </td>
                </tr>
<?
}
?>				
              </form>
            </table>
            <table width="90%" border="0" cellspacing="0" cellpadding="0">
              <tr>
                <td align="center"><?
/* 페이지 번호 리스트 부분 */
/* PREVIOUS or First 부분 */
$TransData = "item=$item&page=$next&search=$search&keyword=$keyword&keykind=$keykind";	
if ( $CB > 1 ) {
$PREV_PAGE = $SP - 1;
echo " <a href='$PHP_SELF?CP=$PREV_PAGE&$TransData'>Prev</a> ";
} else {
echo " Prev ";
 }


/* LISTING NUMBER PART */
for ($i = $SP; $i <= $EP && $i <= $TP ; $i++) {
if($CP == $i){$NUMBER_SHAPE= "<B>${i}</B>";}
else $NUMBER_SHAPE=${i};
ECHO" <A HREF='$PHP_SELF?CP=$i&$TransData'>$NUMBER_SHAPE</a> ";
}

/* NEXT or END PART */
if ($CB < $TB) {
$NEXT_PAGE = $EP + 1;
ECHO " <a href='$PHP_SELF?CP=$NEXT_PAGE&$TransData'>Next</a> ";
} else {
ECHO" Next ";
}
?></td>
              </tr>
            </table></td>
        </tr>
        <tr>
          <td width="10" height="5"></td>
        </tr>
      </table>
      
      <table width="100%" border="0" cellspacing="0" cellpadding="0">
        <form name="search_member" method="post">
          <input type="hidden" name="search" value="on">
          <input type="hidden" name="val" value="<?=$val?>">
          <tr>
            <td height="10"></td>
          </tr>
          <tr>
            <td align="center"><select name="keykind" onChange="select_change(this.options[this.selectedIndex].value)" class="memo">
                <option value="name" <?if($keykind=="name")echo "selected";?>>이름</option>
                <option value="user_id" <?if($keykind=="user_id")echo "selected";?>>아이디</option>
                <option value="all">모두</option>
              </select>
              <input type="text" name="keyword" value="<?echo $keyword;?>" onKeyPress="if(event.keyCode==13) return findCheck();">
              <a href="javascript:document.search_member.submit();" onClick="JavaScript:return findCheck();" style="cursor:hand;"> <img src="./images/pop_seach.gif" border="0" align="absmiddle"></a> </td>
          </tr>
        </form>
      </table>
</body>
</html>
