<?
/************************************************/
/**                                            **/
/**    프로그래명 : wizMailer For wizMall      **/
/**                                            **/
/**    수정자 : 폰돌                           **/
/**                                            **/
/**    수정일 : 2002.8.20                      **/
/**    두번째 수정일 : 2003. 05.13             **/
/************************************************/
/* 위즈몰용으로 기존 프로그램을 수정보완하였습니다.
현재 프로그램을 wizMember의 wizMembers DB와 호환되게 다시 수정 보완 배포합니다.
E-mail : master@shop-wiz.com
Url : http://www.shop-wiz.com
상업적 목적이 없는 한 수정 및 재 배포가 자유롭습니다. 
단, 수정시 상기를 표시해 주시면 감솨여....^^
Upgrade 2003.08.20 wizmall에 맞게 재구성
2003.10.10  성별 에러 발생되던 것을 수정 및 등급별 발송 선택
2004. 05. 12 스킨선택기능 삽입
2004. 06 30 개인Address에서 가져오기 기능 추가
2004. 07 9  텍스트로 된 대량 메일 발송 기능 추가
 */
?>
<script language="Javascript">
<!--
function display(flag){
var f= document.messageform;

	if(flag == '1'){//회원테이블로 부터 메일 보내기
		optionTable1.style.display = 'block';
		optionTable2.style.display = 'none';
		optionTable3.style.display = 'none';
		optionTable4.style.display = 'none';
		optionTable5.style.display = 'none';
		f.theme.value="mail/mailer2";
	}else if(flag == '2'){//주소록 Table로 부터 메일 보내기
		optionTable1.style.display = 'none';
		optionTable2.style.display = 'block';
		optionTable3.style.display = 'none';
		optionTable4.style.display = 'none';
		optionTable5.style.display = 'none';
		f.theme.value="mail/mailer2_1";
	}else if(flag == '3'){//단체개별메일보내기
		optionTable1.style.display = 'none';
		optionTable2.style.display = 'none';
		optionTable3.style.display = 'block';
		optionTable4.style.display = 'none';
		optionTable5.style.display = 'none';
		f.theme.value="mail/mailer2_2";
	}else if(flag == '4'){//csv파일로 부터 메일보내기
		optionTable1.style.display = 'none';
		optionTable2.style.display = 'none';
		optionTable3.style.display = 'none';
		optionTable4.style.display = 'block';
		optionTable5.style.display = 'none';
		f.theme.value="mail/mailer2_3";
	}else if(flag == '5'){//뉴스레터로 부터 메일보내기
		optionTable1.style.display = 'none';
		optionTable2.style.display = 'none';
		optionTable3.style.display = 'none';
		optionTable4.style.display = 'none';
		optionTable5.style.display = 'block';
		f.theme.value="mail/mailer2_4";
	}
}

//-->
</script>
<table class="table_outline">
  <tr>
    <td valign="top"><fieldset class="desc">
						<legend>메일발송하기</legend>
						<div id="notice">[note]</div>
						<div id="comment">메일발송옵션에서 선택된 회원에게 메일이 발송됩니다.<br />
                      메일발송은 서버에 부하가 주어지므로 만단위 이상의 메일은 자제해 주시기 바랍니다. </div>
						</fieldset>
						<p></p>	
					    <table class="table_main">
        <form name=messageform method=post action="<?=$PHP_SELF?>" enctype='multipart/form-data'>
		<input type='hidden' name='menushow' value='<?=$menushow?>'>
		<input type="hidden" name="theme" value="mail/mailer2">
          <tr> 
            <td align=middle bgcolor=E6E9EA>보내는 분</td>
            <td align=left bgcolor=#ffffff>  
              <input type="text" size=50 name="FromName" value="<?=$cfg["admin"]["ADMIN_TITLE"]?>" />
              (예) 숍핑몰 관리자</td>
          </tr>
          <tr> 
            <td align=middle bgcolor=E6E9EA>Email</td>
            <td align=left bgcolor=#ffffff>  
              <input name="FromEmail" value="<?=$cfg["admin"]["ADMIN_EMAIL"]?>" size="50">
              (예)master@shop-wiz.com</td>
          </tr>
          <tr> 
            <td align=middle bgcolor=E6E9EA>Reply-To </td>
            <td align=left bgcolor=#ffffff> <input name="reply" value="<?=$cfg["admin"]["ADMIN_EMAIL"]?>" size=50>
              (예) master@shop-wiz.com</td>
          </tr>
          <tr> 
            <td align=middle bgcolor=E6E9EA>제목</td>
            <td align=left bgcolor=#ffffff>  
              <input size=81 
                        name=subject>
              </td>
          </tr>
          <tr> 
            <td align=middle bgcolor=E6E9EA height=27>텍스트타입</td>
            <td align=left bgcolor=#ffffff height=27>  
              <input 
                        type=radio CHECKED value=0 name=contenttype>
              HTML 로 보내기 
              <input type=radio value=1 name=contenttype>
              TXT 로 보내기 </td>
          </tr>
          <tr> 
            <td align=middle bgcolor=E6E9EA height=27>스킨선택</td>
            <td align=left bgcolor=#ffffff height=27>  
              <select style="WIDTH: 160px" name=MailSkin>
                <option value="">스킨없슴</option>
                <?
$vardir = "./mailskin";
$open_dir = opendir($vardir);
        while($opendir = readdir($open_dir)) {
                if(($opendir != ".") && ($opendir != "..") && is_dir("$vardir/$opendir")) {
                                echo "<option value=\"$opendir\">$opendir 스킨</option>\n";
                }
        }
closedir($open_dir);
?>
              </select>
              </td>
          </tr>
          <tr> 
            <td align=middle bgcolor=E6E9EA>내용</td>
            <td align=left bgcolor=#ffffff> <textarea name=body_txt rows=15 cols=80></textarea> 
            </td>
          </tr>
          <tr> 
            <td align=middle bgcolor=E6E9EA>파일첨부 </td>
            <td align=left bgcolor=#ffffff>  
              <input name="userfile" type="file" id="userfile"></td>
          </tr>
          <tr> 
            <td align=middle bgcolor=E6E9EA>메일Table선택</td>
            <td align=left bgcolor=#ffffff>
              <input name="addsource" type="radio" value="1" checked onClick="display('1')">
              회원Table 
              <input type="radio" name="addsource" value="2" onClick="display('2')">
              주소록Table 
              <input type="radio" name="addsource" value="3" onClick="display('3')">
              단체개별메일 <input type="radio" name="addsource" value="4" onClick="display('4')">
              csv파일 <input type="radio" name="addsource" value="5" onClick="display('5')">
              뉴스레터신청 </td>
          </tr>
          <tr> 
            <td align=middle bgcolor=E6E9EA>메일발송옵션</td>
            <td align=left bgcolor=#ffffff> <table cellspacing=0 cellpadding=0 width="100%" border=0 class="s1" id="optionTable1">
                <tbody>
                  <tr> 
                    <td>  
                      <input type=radio value="all" name="soption">
                      전체 &nbsp;&nbsp;&nbsp; 
                      <input type="checkbox" CHECKED value="1" name="mailreject">
                      수신거부회원은 메일 발송안함</td>
                  </tr>
                  <tr> 
                    <td>  
                      <input type=radio value="seq" name="soption">
                      번호순 
                      <input size=10 value=1 name=startseq>
                      - 
                      <?
$query = "select max(UID) from wizMembers order by UID desc";
$maxseq = $dbcon->get_one($query);
?>
                      <input name=stopseq value="<?=$maxseq?>" size=10>
                      </td>
                  </tr>
                  <tr> 
                    <td>  
                      <input type=radio value="gender" name="soption">
                      성별 
                      <select size=1 name="genderSelect">
                        <option value="1" selected>남자</option>
                        <option value="2">여자</option>
                      </select>
                      </td>
                  </tr>
                  <tr> 
                    <td>  
                      <input type=radio value="grade" name="soption">
                      등급별메일보내기 
                      <select size=1 name="gradeSelect">
                        <option value="10">10</option>
                        <option value="9">9</option>
                        <option value="8">8</option>
                        <option value="7">7</option>
                        <option value="6">6</option>
                        <option value="5">5</option>
                        <option value="4">4</option>
                        <option value="3">3</option>
                        <option value="2">2</option>
                        <option value="1">1</option>
                      </select>
                      </td>
                  </tr>
                  <tr> 
                    <td>  
                      <input type=radio CHECKED value="testMail" name="soption">
                      개인멜 
                      <input name="testMailAddress">
                      (하나의 이멜을 적어주세요 - 테스트용)</td>
                  </tr>
                  <tr> 
                    <td>&nbsp;</td>
                  </tr>
                </tbody>
              </table>
              <table width="100%" border="0" cellspacing="0" cellpadding="0"  class="s1" id="optionTable2" style="display:none">
                <tr> 
                  <td>
<input type="radio" value="all" name="queryind">
                    전체 </td>
                </tr>
                <tr> 
                  <td> 
                      <input type=radio CHECKED value=amail name=queryind>
                      개인멜 
                      <input name=personalind>
                      (하나의 이멜을 적어주세요 - 테스트용)</td>
                </tr>
                <tr>
                  <td>&nbsp;</td>
                </tr>
              </table>
              <table width="100%" border="0" cellspacing="0" cellpadding="0"  class="s1" id="optionTable3" style="display:none">
                <tr> 
                  <td> <input type="radio" value="all" name="querymass"> 전체 
                  </td>
                </tr>
                <tr> 
                  <td> 
                    <input type=radio CHECKED value=amail name=querymass>
                    개인멜 
                    <input name=personalmass>
                    (하나의 이멜을 적어주세요 - 테스트용)</td>
                </tr>
                <tr> 
                  <td> &nbsp; 
                    <table width="100%" border="0" cellspacing="0" cellpadding="0">
                      <tr>
                        <td><textarea name="userMailList" rows="20" id="userMailList"></textarea></td>
                        <td width="15">&nbsp;</td>
                        <td><textarea name="textarea2" cols="50" rows="20" wrap="PHYSICAL" disabled>사용예
이메일주소를 아래와 같이 일련으로 카피합니다.

abc@abc.co.kr
xxx@ac.com
kor@korea.com
yyy@check.co.kr</textarea></td>
                      </tr>
                    </table></td>
                </tr>
                <tr>
                  <td>&nbsp;</td>
                </tr>
              </table><table width="100%" border="0" cellspacing="0" cellpadding="0"  class="s1" id="optionTable4" style="display:none">
                <tr> 
                  <td> <input type="radio" value="all" name="mail4_target"> 전체 
                  </td>
                </tr>
                <tr> 
                  <td> 
                    <input type=radio CHECKED value=amail name="mail4_target">
                    개인멜 
                    <input name=personalmass>
                    (하나의 이멜을 적어주세요 - 테스트용)</td>
                </tr>
                <tr> 
                  <td>&nbsp;  
                 </td>
                </tr>
                <tr>
                  <td>&nbsp;</td>
                </tr>
              </table><table width="100%" border="0" cellspacing="0" cellpadding="0"  class="s1" id="optionTable5" style="display:none">
                <tr> 
                  <td> <input type="radio" value="all" name="mail5_target"> 전체 
                  </td>
                </tr>
                <tr> 
                  <td> 
                    <input type=radio CHECKED value=amail name="mail5_target">
                    개인멜 
                    <input name=personalmail5>
                    (하나의 이멜을 적어주세요 - 테스트용)</td>
                </tr>
                <tr> 
                  <td>&nbsp;  
                 </td>
                </tr>
                <tr>
                  <td>&nbsp;</td>
                </tr>
              </table></td>
          </tr>
          <tr align="center" bgcolor=#ffffff> 
            <td colspan=2> <input type="image" src="img/mail.gif" width="90" height="20">
              &nbsp;&nbsp;&nbsp; </td>
          </tr>
        </form>
      </table>
      <br /> <b></b> </td>
  </tr>
</table>
