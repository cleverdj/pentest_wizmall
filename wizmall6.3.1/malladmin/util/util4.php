<?
#CREATE TABLE `wizbanner` (
#  `uid` int(11) NOT NULL auto_increment,
#  `flag1` varchar(10) NOT NULL default '',
#  `ordernum` int(5) NOT NULL default '0',
#  `url` varchar(50) NOT NULL default '',
#  `target` varchar(20) NOT NULL default 'root',
#  `attached` varchar(250) NOT NULL default '',
#  `wdate` int(13) NOT NULL default '0',
#  PRIMARY KEY  (`uid`)
#) TYPE=MyISAM AUTO_INCREMENT=1 ;
$BOARD_NAME="wizbanner";
/******************************************************************************/
?>
<?
if ($query == 'delete') {   //삭제옵션시 실행
while (list($key,$value) = each($_GET)) {
        if(ereg("deleteItem", $key)) {
                $VIEW_QUERY = "SELECT * FROM $BOARD_NAME WHERE uid='$value'";
                $LIST = $dbcon->_fetch_array($dbcon->_query($VIEW_QUERY));
				$Loaded = split("\|", $LIST[UPDIR1]);
				for($i=0; $i<sizeof($Loaded); $i++){
               	 if (is_file("../wizstock/$Loaded[$i]") && $Loaded[$i]) {
                  	      unlink("../wizstock/$Loaded[$i]");
				 }
                }
                $dbcon->_query("DELETE FROM $BOARD_NAME WHERE uid=$value");
        }
} 
} //삭제옵션 끝
?>
<?
//include "../wizboard/func/STR_CUTTING_FUNC.php";
$WHERE = "WHERE uid <> '0' and flag1 = '$flag1'";
/* 총 갯수 구하기 */
$TOTAL_STR = "SELECT count(uid) FROM $BOARD_NAME $WHERE";
$TOTAL = $dbcon->get_one($TOTAL_STR)
$LIST_NO=10; /* 페이지당 출력 리스트 수 */
$PageNo=10; /* 페이지 밑의 출력 수 */
if(empty($SUB_cp) || $SUB_cp <= 0) $SUB_cp = 1;
//--페이지 나타내기--
?>
<SCRIPT LANGUAGE=javascript>
function deletefnc(){
        var f = document.forms.BrdList;
        var i = 0;
        var chked = 0;
        for(i = 0; i < f.length; i++ ) {
                if(f[i].type == 'checkbox') {
                        if(f[i].checked) {
                                chked++;
                        }
                }
        }
        if( chked < 1 ) {
                alert('삭제하고자 하는 게시물을 하나 이상 선택해 주세요.');
                return false;
        }
        if (confirm('\n\n삭제하는 게시물은 복구가 불가능합니다!!! \n\n정말로 삭제하시겠습니까?\n\n')) return true;
        return false;
}
</SCRIPT>
<table class="table_outline">
  <tr>
    <td valign="top"><fieldset class="desc">
						<legend>베너관리</legend>
						<div id="notice">[note]</div>
						<div id="comment">order가 작은 순서가 상위에 위치합니다.</div>
						</fieldset>
						<p></p>
      <table class="table_main">
        <form action="<?=$PHP_SELF?>" Name="BrdList" onsubmit='return deletefnc()'>
          <input type='hidden' name='menushow' value='<?=$menushow?>'>
          <input type="hidden" name="theme" value="<?=$theme;?>">
          <input type="hidden" name="cp" value="<?=$cp?>">
          <input type="hidden" name="SUB_cp" value="<?=$SUB_cp?>">
          <input type="hidden" name="query" value="delete">
		  <input type="hidden" name="flag1" value="<?=$flag1?>">
          <tr align="center" bgcolor="E0E4E8"> 
            <td width="30">삭제</td>
            <td width="50">order</td>
            <td>url</td>
            <td width="150">이미지</td>
            <td width="70" bgcolor="E0E4E8">수정</td>
          </tr>
          <? 
$START_NO = ($SUB_cp - 1) * $LIST_NO;
$BOARD_NO=$TOTAL-($LIST_NO*($SUB_cp-1));
$SELECT_STR="SELECT * FROM $BOARD_NAME $WHERE ORDER BY uid DESC LIMIT $START_NO, $LIST_NO";
$SELECT_QRY=$dbcon->_query($SELECT_STR);
while($LIST=@$dbcon->_fetch_array($SELECT_QRY)):
?>
          <tr bgcolor="#FFFFFF"> 
            <td align="center"><input type="checkbox" name="deleteItem_<?=$LIST[uid]?>" value="<?=$LIST[uid]?>">            </td>
            <td align="center"> 
              <?=$LIST[ordernum];?>            </td>
            <td> 
              <?=$LIST[url];?></td>
            <td align="center"> 
              <img src="../wizstock/<?=$LIST[attached]?>" width=100>            </td>
            <td align="center"><a href="<?=$PHP_SELF?>?menushow=<?=$menushow?>&theme=util/util4_write&flag1=<?=$flag1?>&mode=update&uid=<?=$LIST[uid];?>"><img src="img/su.gif" width="53" height="20" border="0" /></a></td>
          </tr>
          <?
$BOARD_NO--;
endwhile;
?>
          <tr align="center" bgcolor="F2F2F2"> 
            <td colspan="5"> <table width="100%" border="0" cellspacing="0" cellpadding="0">
                <tr> 
                  <td width="5%" align="center"> <input type="image" style="cursor:pointer" src="img/del02.gif" align="middle" width="53" height="20">                  </td>
                  <td width="95%"><a href="<?=$PHP_SELF?>?menushow=<?=$menushow?>&theme=util/util4_write&flag1=<?=$flag1?>&mode=insert"><img src="img/dung.gif" width="55" height="20" border="0" align="absmiddle"></a></td>
                </tr>
              </table></td>
          </tr>
        </form>
      </table>

      <table width="760" border="0" cellpadding="0" cellspacing="0" class="s1">
        <tr> 
                                              
          <td align="center">
          <?
/* 페이지 번호 리스트 부분 */
/* PREVIOUS or First 부분 */
$page_arg1 = $PHP_SELF."?menushow=$menushow&theme=$theme&flag1=$flag1&cp=$cp&stitle=$stitle&keyword=".urlencode($keyword);
$page_arg2 = array("listno"=>$ListNo,"pageno"=>$PageNo,"cp"=>$cp,"total"=>$TOTAL); 
//$page_arg3 = array("pre"=>"./img/pre.gif","next"=>"./img/next.gif");
echo $common->paging($page_arg1,$page_arg2,$page_arg3);
?>

          </td>
                                            </tr>
                                          </table>
                </td>
              </tr>
            </table>