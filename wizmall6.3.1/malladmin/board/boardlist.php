<?
/* 
powered by 폰돌
Reference URL : http://www.shop-wiz.com
Contact Email : master@shop-wiz.com
Free Distributer : 

Copyright shop-wiz.com
*/
?>
<?
/* 인자의  Valid 여부 check */
$BOARD_NAME="wizTable_${AdminBID}";
/******************************************************************************/
if ( !$AdminBID || !is_dir("../wizboard/table/$AdminBID") )
{
   ECHO "<script>window.alert('\\n\\n존재하지 않는 보드입니다.\\n\\n');
   history.go(-1);</script>";
        exit;
}
?>
<?
if ($query == 'delete') {   //삭제옵션시 실행
while (list($key,$value) = each($_GET)) {
        if(ereg("deleteItem", $key)) {
                $VIEW_QUERY = "SELECT * FROM $BOARD_NAME WHERE UID='$value'";
                $LIST = $dbcon->_fetch_array($dbcon->_query($VIEW_QUERY));
				$Loaded = split("\|", $LIST[UPDIR1]);
				for($i=0; $i<sizeof($Loaded); $i++){
               	 if (is_file("../wizboard/table/$AdminBID/updir/$Loaded[$i]") && $Loaded[$i]) {
                  	      unlink("../wizboard/table/$AdminBID/updir/$Loaded[$i]");
				 }
                }
                $dbcon->_query("DELETE FROM $BOARD_NAME WHERE UID=$value");
        }
} 
} //삭제옵션 끝
?>
<?
include "../wizboard/func/STR_CUTTING_FUNC.php";
$WHERE = "WHERE BID <> '0'";
/* 검색 키워드 및 WHERE 구하기 */
//if($SEARCHTITLE && $searchkeyword){
//$WHERE = "WHERE $SEARCHTITLE LIKE '%$searchkeyword%'";
//}
//else $WHERE="";
/* 총 갯수 구하기 */
$TOTAL_STR = "SELECT count(UID) FROM $BOARD_NAME $WHERE";
$TOTAL = $dbcon->get_one($TOTAL_STR);
$LIST_NO=10; /* 페이지당 출력 리스트 수 */
$PageNo=10; /* 페이지 밑의 출력 수 */
if(empty($SUB_cp) || $SUB_cp <= 0) $SUB_cp = 1;
?>
<SCRIPT LANGUAGE=javascript>
function deletefnc(){
        var f = document.forms.BrdList;
        var i = 0;
        var chked = 0;
        for(i = 0; i < f.length; i++ ) {
                if(f[i].type == 'checkbox') {
                        if(f[i].checked) {
                                chked++;
                        }
                }
        }
        if( chked < 1 ) {
                alert('삭제하고자 하는 게시물을 하나 이상 선택해 주세요.');
                return false;
        }
        if (confirm('\n\n삭제하는 게시물은 복구가 불가능합니다!!! \n\n정말로 삭제하시겠습니까?\n\n')) return true;
        return false;
}
</SCRIPT>
<table width="760" border="0" cellpadding="0" cellspacing="0" class="s1">
        <tr> 
                                              
          
    <td><b><?=$AdminBID;?></b> 테이블 리스트입니다. </td>
                                            </tr>
                                          </table>
<table cellspacing=1 bordercolordark=white width="760" bgcolor=#c0c0c0 bordercolorlight=#dddddd border=0 class="s1">
<form action="<?=$PHP_SELF?>" Name="BrdList" onsubmit='return deletefnc()'>	 
<input type="hidden" name="AdminBID" value="<?=$AdminBID?>">
<input type='hidden' name='menushow' value='<?=$menushow?>'>
<input type="hidden" name="theme" value="boardadmin">
<input type="hidden" name="cp" value="<?=$cp?>">
<input type="hidden" name="SUB_cp" value="<?=$SUB_cp?>">
<input type="hidden" name="query" value="delete">
        <tr align="center" bgcolor="F2F2F2"> 
          <td> </td>
          <td>NO.</td>
          <td>제목</td>
          <td>글쓴이</td>
          <td>등록일</td>
          <td>조회수</td>
          <td>추천수</td>
          <td>수정</td>
        </tr>
<? 
$START_NO = ($SUB_cp - 1) * $LIST_NO;
$BOARD_NO=$TOTAL-($LIST_NO*($SUB_cp-1));
$SELECT_STR="SELECT * FROM $BOARD_NAME $WHERE ORDER BY FID DESC, THREAD ASC, UID DESC LIMIT $START_NO, $LIST_NO";
$SELECT_QRY=$dbcon->_query($SELECT_STR);
while($LIST=@$dbcon->_fetch_array($SELECT_QRY)):
$LIST[SUBJECT]=stripslashes($LIST[SUBJECT]);
$LIST[W_DATE] = ereg_replace("\-",".",$LIST[W_DATE]);
/* REPLY에 이미지가 있을 경우 아래 방법을 사용합니다. */
$IMGNUM=strlen($LIST[THREAD])-1;
$SPACE="";
for($i=0; $i<$IMGNUM-1; $i++){
$SPACE .="&nbsp;&nbsp;";
}
?>
        <tr bgcolor="#FFFFFF"> 
          <td align="center"><input type="checkbox" name="deleteItem_<?=$LIST[UID]?>" value="<?=$LIST[UID]?>"> 
          </td>
          <td align="center"> 
            <?=$BOARD_NO;?>
          </td>
          <td> 
            <? if($IMGNUM){ECHO"${SPACE} Re_";} ?>
            <a href="javascript:void(window.open('../wizboard.php?BID=<?=$AdminBID;?>&mode=view&UID=<?=$LIST[UID];?>&SUB_cp=<?=$SUB_cp;?>&BOARD_NO=<?=$BOARD_NO;?>&Goto=<?=$PHP_SELF?>','BoardViewWindow',''))"> 
             
            <?=$LIST[SUBJECT];?>
             </a></td>
          <td align="center"> 
            <?=$LIST[NAME];?>
          </td>
          <td align="center"> 
            <? echo date("Y.m.d",$LIST[W_DATE]);?>
          </td>
          <td align="center"> 
            <?=$LIST[COUNT];?>
          </td>
          <td align="center"> 
            <?=$LIST[RECCOUNT];?>
          </td>
          
      <td align="center"> <img src="img/su.gif" width="53" height="20" border="0" onClick="javascript:window.open('../wizboard.php?BID=<?=$AdminBID?>&mode=modify&UID=<?=$LIST[UID];?>&SUB_cp=<?=$SUB_cp;?>','수정모드','');" style="cursor:pointer";> 
      </td>
        </tr>
        <?
$BOARD_NO--;
endwhile;
?>
        <tr align="center" bgcolor="F2F2F2"> 
          <td colspan="8"> 
            <table width="100%" border="0" cellspacing="0" cellpadding="0">
              <tr>
                
            <td width="5%" align="center"> 
              <input type="image" style="cursor:pointer" src="img/del02.gif" align="middle" width="53" height="20"> </td>
                <td width="95%"><img src="img/dung.gif" width="55" height="20" align="absmiddle" style="cursor:pointer" onClick="javascript:window.open('../wizboard.php?BID=<?=$AdminBID?>&mode=write','WRITEMODE','');";></td>
              </tr>
            </table> </td>
        </tr></form>
      </table></td>

      <table width="760" border="0" cellpadding="0" cellspacing="0" class="s1">
        <tr> 
                                              
          <td align="center"><?
/* 페이지 번호 리스트 부분 */
/* PREVIOUS or First 부분 */
$page_arg1 = $PHP_SELF."?AdminBID=$AdminBID&menushow=$menushow&theme=$theme&cp=$cp&SEARCHTITLE=$SEARCHTITLE&searchkeyword=".urlencode($searchkeyword);
$page_arg2 = array("listno"=>$ListNo,"pageno"=>$PageNo,"cp"=>$cp,"total"=>$TOTAL); 
//$page_arg3 = array("pre"=>"./img/pre.gif","next"=>"./img/next.gif");
echo $common->paging($page_arg1,$page_arg2,$page_arg3);
?>
    </td>
                                            </tr>
                                          </table>
