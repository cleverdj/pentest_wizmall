<?
/* 
powered by 폰돌
Reference URL : http://www.shop-wiz.com
Contact Email : master@shop-wiz.com
Free Distributer : 
Copyright shop-wiz.com
*** Updating List ***
*/

## html 편집기 사용시 현재 폴더에 임시 폴더를 넣어둔다.

$htmleditimgfolder=session_id();

if ($query == 'delete') {   //이미지 택일 삭제옵션시 실행	
	$admin->pd_img_delete($uid, $idx);
	$common->js_location("$PHP_SELF?menushow=$menushow&theme=$theme&mode=$mode&uid=$uid&cp=$cp");
}else if ($query == 'qin' || $query == 'qup') {//Insert 실행
	include "../lib/class.image.php";
	$Image = new Image();//이미지 클라스 사용
	$common->Image($Image);

	$Name = addslashes(chop($Name));
	$Model = addslashes(chop($Model));
	if($Category3) $Category = $Category3;
	else if($Category2) $Category = $Category2;
	else if($Category1) $Category = $Category1;
	else $common->js_alert("카테고리가 설정되지 않았습니다.");
	
	$des_type1 = $des_type1 ? $des_type1 : 0;//Description1 텍스트 타입0:html 미적용, 1:html적용
	$des_type2 = $des_type2 ? $des_type2 : 0;
	$des_type3 = $des_type3 ? $des_type3 : 0;
	$TextType = $des_type1."|".$des_type2."|".$des_type3;
		
	$Description1=$common->puttrimstr($Description1, $des_type1);
	$Description2=$common->puttrimstr($Description2, $des_type2);
	$Description3=$common->puttrimstr($Description3, $des_type3);

	## 등록 옵션 입력하기 
	unset($Regoption);
	for($i=0; $i < count($RegOptionArr); $i++){
		if(!$Multi_Regoption[$i]) $Multi_Regoption[$i] = "0";
		$Regoption .= $Multi_Regoption[$i]."|";
	}
			
	if($query == "qin"){
		$Date = time();
		## 상품이미지 올리기
		if($watermark){
			$admin->watermark = $watermark;//워트마크 생성여부 
			if($watermark == "text"){
				$admin->watermark_text = $watermark_text;
				$admin->watermark_font = "arial.ttf";
			}else if($watermark == "img"){
				$admin->watermark_img = $watermark_img;
			}
		}
		$rtnfile = $admin->pd_img_up("insert", "file", $Category, $copyimg);

		/*PID를 구한다.*/
		$MaxUID = $dbcon->get_one("select max(UID) from wizMall");
		if(!$MaxUID) $uid = 1; else $uid = $MaxUID+1;
		
		## html편집기에서 이미지가 첨부되었을 경우 경로수정 및 파일 이동
		$Description1 = $admin->htmleditorImg($Description1, $uid);
		
		/* 쿼리문 시작 */
		$QUERY1 = "INSERT INTO wizMall (
		UID,PID,Name,Brand,CompName,Price,Price1,WongaPrice,Point,Unit,Model,Regoption,SimilarPd,
		Picture,None,Output,Stock,Date,Description1,Description2,Description3,Category,TextType,Hit,GetComp,opflag)
		VALUES(
		'$uid','$uid','$Name','$Brand','$CompName','$Price','$Price1','$WongaPrice','$Point','$Unit','$Model','$Regoption',
		'$SimilarPd','".$rtnfile[1]."','$None','$Output','$Stock','$Date','$Description1','$Description2','$Description3','$Category','$TextType',
		'$Hit','$GetComp', '$cobuy')";
		$dbcon->_query($QUERY1);

		$mall->insertPdCnt($Category);##카테고리별 상품갯수 입력
		
		$admin->MultiInsert($uid, $TmpMultiCategoryvalue);//다중카테고리 입력
	
		$admin->input_mallext($uid, $_POST);//확장 필드 입력

		$admin->input_imgtable($uid, $rtnfile);//이미지 테이블에 이미지 명 입력

		
	## 재고수량이 기입되었을 경우 재고수량을 입력한다.
		if($Stock){
			$Iinputdate = time();
			$sqlstr = "INSERT INTO wizInputer (Icomid, Igoodscode, Iinputqty,Iinputdate) VALUES('$Icomid', '$uid', '$Stock', '$Iinputdate')";
			$dbcon->_query($sqlstr);
		}
		
	
	## 등록 옵션 입력하기
		if($optioncnt){
			$oorder=0;
			foreach($opname as $key=> $value){
				$ropflag = $opflag[$key];
				$sqlstr = "insert into wizMalloptioncfg (opid, oname, oorder, oflag) values ('$uid', '$value', '$oorder', '$ropflag')";
				$dbcon->_query($sqlstr);
				$ouid = $dbcon->_insert_id();
				$oorder++;
				
				if($opcnt[$key]){
					foreach($optioneachname[$key] as $key1=>$value1){
						$roprice = $optioneachprice[$key][$key1];
						$roqty = $optioneachqty[$key][$key1];
						$sqlstr = "insert into wizMalloption (ouid,oname,oprice,oqty) values ('$ouid', '$value1', '$roprice', '$roqty')";
						//echo $sqlstr;
						$dbcon->_query($sqlstr);
					}			
				}
			}
		}
		
		## 공동구매등록
		if($cobuy == "c"){
			$c_sdate = mktime(0,0,0, $SMonth, $SDay, $SYear);
			$c_fdate = mktime(0,0,0, $FMonth, $FDay, $FYear);
			$admin->coorbuy("insert", $uid, $c_sdate, $c_fdate, $c_price, $c_qty);
		}

		$common->js_confirm("동종 상품 추가등록을 하시겠습니까?", "history.go(-1)", "$PHP_SELF?menushow=$menushow&theme=$theme&Category=$Category");
	}else if ($query == 'qup') {//update 실행
		## html편집기에서 이미지가 첨부되었을 경우 경로수정 및 파일 이동
		$Description1 = $admin->htmleditorImg($Description1, $uid);


		## 상품이미지 올리기
		$rtnfile = $admin->pd_img_up("update", "file", $Category, $copyimg, $c_category, $uid);

		/* omit 된 내용 : Output = '$Output', Stock = '$Stock',*/
		$sqlstr = "UPDATE wizMall SET
		PID = '$uid',
		Name = '$Name',
		Brand = '$Brand',
		CompName = '$CompName',
		Price = '$Price',
		Price1 = '$Price1',
		WongaPrice = '$WongaPrice',
		Point = '$Point',
		Unit = '$Unit',
		Model = '$Model',
		Regoption = '$Regoption',
		SimilarPd = '$SimilarPd',
		Picture = '".$rtnfile[1]."',
		None = '$None',
		Description1 = '$Description1',
		Description2 = '$Description2',
		Description3 = '$Description3',
		Category = '$Category',
		TextType = '$TextType',
		Hit = '$Hit',
		GetComp = '$GetComp' WHERE UID='$uid'";
		$dbcon->_query($sqlstr);
		
		$admin->input_mallext($uid, $_POST);//확장 필드 입력
	
		
		$mall->insertPdCnt($c_category, "delete");##카테고리별 상품갯수 삭제
		$mall->insertPdCnt($Category);##카테고리별 상품갯수 입력
		
		$admin->MultiInsert($uid, $TmpMultiCategoryvalue);## 다중카테고리 입력
	
		$sqlstr = "UPDATE wizInputer SET
		Iinputprice = '$Iinputprice',
		Iunit = '$Iunit',
		Icomid= '$GetComp'
		WHERE Igoodscode='$uid'";
		$dbcon->_query($sqlstr);
	
		$admin->input_imgtable($uid, $rtnfile);//이미지 테이블에 이미지 명 입력
		
		##삭제되는 값의 존재 여부 확인이 어려우므로 모두 삭제하고 새로 입력한다.
		$sqlstr = "select uid from wizMalloptioncfg where opid = '$uid'";
		$qry=$dbcon->_query($sqlstr);
		while($list = $dbcon->_fetch_array($qry)):
			$ouid = $list["uid"];
			$substr = "delete from wizMalloption where ouid = '$ouid'";
			$dbcon->_query($substr);
		endwhile;

		$sqlstr = "delete from wizMalloptioncfg where opid = '$uid'";
		$dbcon->_query($sqlstr);
		
		if(is_array($opname)){
			$oorder=0;
			foreach($opname as $key=> $value){
				$ropflag = $opflag[$key];
				$sqlstr = "insert into wizMalloptioncfg (opid, oname, oorder, oflag) values ('$uid', '$value', '$oorder', '$ropflag')";
				//echo $sqlstr."<br />";
				$dbcon->_query($sqlstr);
				$ouid = mysql_insert_id();
				$oorder++;
				
				if(is_array($optioneachname[$key])){
					foreach($optioneachname[$key] as $key1=>$value1){
						$roprice = $optioneachprice[$key][$key1];
						$roqty = $optioneachqty[$key][$key1];
						$sqlstr = "insert into wizMalloption (ouid,oname,oprice,oqty) values ('$ouid', '$value1', '$roprice', '$roqty')";
						//echo $sqlstr."<br />";
						$dbcon->_query($sqlstr);
					}			
				}
			}
		}
					
		## 공동구매등록
		if($cobuy == "c"){
			$c_sdate = mktime(0,0,0, $SMonth, $SDay, $SYear);
			$c_fdate = mktime(0,0,0, $FMonth, $FDay, $FYear);
			$admin->coorbuy("update", $uid, $c_sdate, $c_fdate, $c_price, $c_qty);
		}
		
		if ($back == 'none') {  //이부분은 품절상품관리 화면으로 넘어갈때 사용
			echo "<HTML>
			<META http-equiv=\"refresh\" content =\"0;url=$PHP_SELF?menushow=$menushow&theme=product/product4\">
			</HTML>";
			exit;
		}else{// 아래는 걍 제품수정에서 넘어갈때입니다.
			echo "<HTML>
			<META http-equiv=\"refresh\" content =\"0;url=$PHP_SELF?menushow=$menushow&theme=product/product2&cp=$cp&category=$s_category&where=$where&keyword=$keyword&OPTI_LIST=$OPTI_LIST&sort=$sort&sort1=$sort1&sort2=$sort2&sorting=$sorting\">
			</HTML>";
			exit;
		}	
	}  
}


if ($uid) { /* 상품 목록을 wizMall Table에서 가져옮 */
	$sqlstr = "SELECT m.*,c.PriceQty,c.SDate,c.FDate FROM wizMall m left join wizcoorbuy c on m.UID=c.PID WHERE m.UID='$uid'";
	$dbcon->_query($sqlstr);
	$list = $dbcon->_fetch_array();
	$list["Name"]			= stripslashes($list["Name"]);
	$list["CompName"]		= stripslashes($list["CompName"]);
	$list[Description1]	= stripslashes($list[Description1]);
	$list[Description2]	= stripslashes($list[Description2]);
	$list[Description3]	= stripslashes($list[Description3]);
	$list[Model]		= stripslashes($list[Model]);
	$Picture			= split("\|",$list[Picture]); 
	$imgFolder			= substr($list["Category"], -3);
	$SimilarPd			= split("\|",$list[SimilarPd]); 
	$des_type			= split("\|", $list["TextType"]);
	$des_type1			= $des_type[0];
	$des_type2			= $des_type[1];
	$des_type3			= $des_type[2];
	
	## 공동구매 관련 정보
	$priceQty			= split("\|\|", $list["PriceQty"]);
	foreach($priceQty as $key=>$value){
		$p_qty[$key]	= split(":", $value);
	}
	$SDate				= $list["SDate"];
	$FDate				= $list["FDate"];	
	
	/* 상품재고 및 기타 상품 공급처에 관한 정보를 가져옮 */
	$inputsqlstr = "select Iinputprice, Iunit from wizInputer where Igoodscode='$uid'";
	$inputsqlqry = $dbcon->_query($inputsqlstr);
	$inputlist = $dbcon->_fetch_array($inputsqlqry);
	
	/* 기타이미지 가지고 옮 */
	## max key 값 가져오기
	$sqlstr = "select max(orderid) from wizMall_img where pid = '$uid'  and opflag= 'm' order by orderid asc";
	$max_value = $dbcon->get_one($sqlstr);

	$sqlstr = "select filename, orderid from wizMall_img where pid = '$uid' order by orderid asc";
	$dbcon->_query($sqlstr);
	while($imglist = $dbcon->_fetch_array()):
		$filename = $imglist["filename"];
		$orderid = $imglist["orderid"];
		$fileimg[$orderid] = $filename;
	endwhile;
	$mode = "qup";
}else{
	$mode = "qin";
}
?>
<script type="text/javascript">
  _editor_url = "../js/htmlarea3/";
  _editor_lang = "en";
</script>
<script type="text/javascript" src="../js/htmlarea3/htmlareajs.php?htmleditimgfolder=<?=$htmleditimgfolder;?>"></script>
<script type="text/javascript">
var editor = null;
//HTMLArea.loadPlugin("CSS");
function initEditor() {
	var editor = new HTMLArea("Description1");
	//editor1.config.pageStyle = "@import url(../js/htmlarea3/examples/custom.css);";
	editor.generate();
	
	//var editor2 = new HTMLArea("ta1");
	//editor2.generate();
	//return false;
	
	//editor.generate();
}
</script>

<script language="javascript" src="../js/jquery.plugins/selectboxes.js"></script>
<script language=javascript>
<!--
function getCategory(v, step) {
	if(step == 1) $("#Category2").removeOption(/./);
	else if(step == 2) $("#Category3").removeOption(/./);
		$.ajax({
		
			type: "GET",
			url: "./product/search_category.php",
			data: "value="+v.value+"&step="+step,//특정변수값을 주어서 결과를 받을때
			dataType: "xml",
			success: function(xml) {
				$(xml).find('channel').each(function(){
					var cat_no = $(this).find('cat_no').text();
					var cat_name = $(this).find('cat_name').text();
					if(step == 1) $("#Category2").addOption(cat_no, cat_name, false);
					else if(step == 2) $("#Category3").addOption(cat_no, cat_name, false);	
					
				}); //close each(
			}//close function(xml)
		}); //close $.ajax(

} //close $(


function checkForm(f) {
	var MultiCategorylen = f.TmpMultiCategory.length;
	var TmpMultivalue = '';		
	var tmparr = "";

	for(var i=0; i< MultiCategorylen; i++){
		if(f.TmpMultiCategory.options[i]) TmpMultivalue += f.TmpMultiCategory.options[i].value + '|';
	}
	f.TmpMultiCategoryvalue.value = TmpMultivalue;
			
	if(!f.tmpSimilarPd) tmpSimilarPd = new Array(); 
	if ( f.Category1.value.length == 0 ) {
		alert( '등록할 카테고리를 선택해주세요' );
		f.Category1.focus();
		return false;
	}else if ( f.Name.value.length == 0 ) {
		alert( '상품의 이름을 입력해주세요' );
		f.Name.focus();
		return false;
	}else if ( f.Price.value.length == 0 ) {
		alert( '상품의 판매가를 입력해주세요' );
		f.Price.focus();
		return false;
	}else{
		if(f.tmpSimilarPd){
			var tmpSimilarPdlen = f.tmpSimilarPd.length
			for (i = 0; i < tmpSimilarPdlen; i++){
				tmparr = tmparr +"|"+f.tmpSimilarPd[i].value;
			}
			f.SimilarPd.value = tmparr
		}
	}
}
//-->
</script>
<script>
<!--
function MultiCategorySelect(selObj){
	var f=document.writeForm
	var aIdx=f.TmpMultiCategory.options.length;
	var str=selObj.options[selObj.selectedIndex].text;
	var itm= new Option(str)
	if(aIdx >= 5){
		window.alert('5개이상 카테고리 적용은 불가능합니다.');//이부분 풀어주시면 무한대.
		return false;
		exit;
	}
	f.TmpMultiCategory.options[aIdx] = itm;
	f.TmpMultiCategory.options[aIdx].value = selObj.options[selObj.selectedIndex].value
}

function DeleteMultiCat(sel){
	var f=document.writeForm
	var selectedIndexNo = sel.selectedIndex;
	sel.options[sel.selectedIndex]=null;
}

function addToPIC()
{
 var oID = document.getElementById('nameToDiv');

  var item = document.createElement("input");
  item.setAttribute('type','file');
  item.setAttribute('name','file[]');
  item.setAttribute('class','dd1');
  oID.appendChild(item);
  
/*
기존 IE 용
	nameToDiv.insertAdjacentElement("BeforeEnd",document.createElement("<br />"));
	nameToDiv.insertAdjacentElement("BeforeEnd",document.createElement("<INPUT type='file' name='file' class='dd1'>"));
	*/
}

function del(no,idx){
	location.href = "<?=$PHP_SELF?>?menushow=<?=$menushow?>&theme=<?=$theme?>&mode=<?=$mode;?>&cp=<?=$cp?>&uid="+no+"&query=delete"+ "&idx="+idx;    	 
}

//옵션관련 자바스크립트 시작
function listOptionCnt(v, inicnt){
	var f = document.writeForm;
	var cnt = parseInt(v.value);
	//alert(cnt);
	var data = "";
	for (i=1+parseInt(inicnt); i <= cnt; i++)    { 
		tmpno = "0"+i;
		var k = i-1;

		data = data +
		"<table  cellpadding=8 cellspacing=0 id='objOption' bgcolor=f3f3f3 border=0 bordercolor=#cccccc style='border-collapse:collapse' class='s1'>"+
		"<tr>"+
		"<td valign='top' id=currPosition>옵션명 : <INPUT name='opname["+k+"]' class='dd1' value='' size=10> "+
		"<select name='opcnt["+k+"]' onChange='listeachOptionCnt(this, "+k+", 0)'>"+
		"<option value='0'>갯수</option>"+
		"<option value='1'>1</option>"+
		"<option value='2'>2</option>"+
		"<option value='3'>3</option>"+
		"<option value='4'>4</option>"+
		"<option value='5'>5</option>"+
		"<option value='6'>6</option>"+
		"<option value='7'>7</option>"+
		"<option value='8'>8</option>"+
		"<option value='9'>9</option>"+
		"<option value='10'>10</option>"+
		"</select> "+
		"<select name='opflag["+k+"]'> "+
		"<option value='0' selected='selected'>기본</option> "+
		"<option value='1'>가격추가</option>"+
		"<option value='2'>원가격변경</option>"+
		"</select></td>"+
		"<td valign='middle'><span id='add_optioneach_"+k+"'></span></td>"+
		"</tr>"+
		"</table>";
		
	}
	if (document.layers){  
		document.layers.add_option.document.write(data);  
		document.layers.add_option.document.close();  
	}else{  
		if (document.all){  
			add_option.innerHTML = data;
			
		}  
	}

}


function listeachOptionCnt(v, uid, inicnt){
	var f = document.writeForm;
	var cnt = v.value;
	var data = "";
	//uid = uid + parseInt(f.optioncntadd.value);
	for (i=1+parseInt(inicnt); i <= cnt; i++)    { 
		tmpno = "0"+i;
		var k = i-1;
		//var k = i-1 + parseInt(f.optioncntadd.value);
		data = data +
		"<table border='0' cellspacing='0' cellpadding='0' class='s1'>"+
		"<tr>"+
		"<td>옵션값:"+
		"<input name='optioneachname["+uid+"]["+k+"]' class='dd1' size='10' /> "+
		"가격:"+
		"<input name='optioneachprice["+uid+"]["+k+"]' class='dd1' size='5' value='0'> "+
		"재고: "+
		"<input name='optioneachqty["+uid+"]["+k+"]' class='dd1' size='3' value='0'></td>"+
		"</tr>"+
		"</table>";
		
	}
	
	if (document.layers){  
		eval("document.layers.add_optioneach_"+uid+".document.write(data)");  
		eval("document.layers.add_optioneach_"+uid+".document.close()");  
	}else{  //if (document.all){ 
	 
		eval("add_optioneach_"+uid+".innerHTML = data");
	}

}

function option_del(el)
{
	idx = el.rowIndex;
	obj = el.parentNode
	obj.deleteRow(idx);
	//deleteRow(idx);
	//deleteRow(el);

}

//옵션관련 자바스크립트 시끝

function dp_coorbuy(v){//공동구매 필드 
	if(v.checked) document.getElementById("cobuyfield").style.display="block";
	else document.getElementById("cobuyfield").style.display="none";
}


function gotobasicinfo(){
	location.href="<?=$PHP_SELF;?>?menushow=<?=$menushow;?>&theme=basicconfig/basic_info2";
}


function dp_watermark(v){//워터 마크 옵션 디피
	document.getElementById("watermark_text").style.display = "none";
    document.getElementById("watermark_img").style.display = "none";
	switch(v.value){
    	case "text":document.getElementById("watermark_text").style.display = "block";break;
        case "img":document.getElementById("watermark_img").style.display = "block";break;
    }
}  
-->
</script>


<script language="JavaScript">
<!--
//비교상품관련
function adSimilarPd(idx)
{
	var tb0 = document.getElementById('tb0');
	var tb = parent.document.getElementById('tb_refer');

	oTr = tb.insertRow(0);
	oTd = oTr.insertCell(-1);
	oTd.innerHTML = tb0.rows[idx].cells[0].innerHTML;
	oTd = oTr.insertCell(-1);
	oTd.innerHTML = tb0.rows[idx].cells[1].innerHTML;

	tb.rows[0].className = "hand";
	tb.rows[0].onclick = function(){ parent.spoit('refer',this); }
	tb.rows[0].ondblclick = function(){ parent.remove('refer',this); }
	parent.react_goods('refer');
}

function react_goods(name)
{
	var tmp = new Array();
	
	var obj = document.getElementById('tb_'+name);
	//alert(obj.rows.length);
	for (i=0;i<obj.rows.length;i++){
	//alert(obj.rows[i].cells[0].innerHTML);
		tmp[tmp.length] = "<div style='float:left;width:0;border:1 solid #cccccc;margin:1px;' title='" + obj.rows[i].cells[1].getElementsByTagName('div')[0].innerText + "'>" + obj.rows[i].cells[0].innerHTML + "</div>";
	}
	document.getElementById(name+'X').innerHTML = tmp.join("") + "<div style='clear:both'>";
}

//-->
</script>
<SCRIPT LANGUAGE="JavaScript"> 
<!-- 
// 파일 첨부시 미리보기 구현
//<INPUT type='file' name='file[0]' onchange="return image_onchange(0);" id=upfile><img alt=미리보기 id=sm src="" width="largh" style="VISIBILITY: hidden"  name="imgsiz" border=1>
function AutoResize(img, flag){ 
	foto1= new Image(); 
	foto1.src=(img); 
	Controlla(img, flag); 
} 
function Controlla(img, flag){ 
	if((foto1.width!=0)&&(foto1.height!=0)){ 
		viewFoto(img, flag); 
	} 
	else{ 
		funzione="Controlla('"+img+"')"; 
		intervallo=setTimeout(funzione,20); 
	} 
} 
function viewFoto(img, flag){ 
	largh=foto1.width; 
	img_width=foto1.width;
	altez=foto1.height;
	img_height=foto1.height;
	if(largh >= 80) {
		largh = 80;
	}
	//if(altez >= 650) {
	//   altez = 450;
	//}
	var imgsiz
	document.imgsiz[flag].width = largh ;
	document.imgsiz[flag].alt = '원본 이미지사이즈 :' + img_width +'×'+ img_height ;
	//document.imgsiz.height = altez ;
	//f.sm.style.visibility="visible";
} 

function image_onchange(flag){    
	var f=document.writeForm;
	sm=new Array(); 
	upfile=new Array(); 
    if(f.upfile.value!=""){
    f.sm[flag].src=f.upfile[flag].value;
    f.sm[flag].style.visibility="visible";
    imgsize = f.upfile[flag].value;
    if(event.srcElement.value.match(/(.jpg|.jpeg|.gif|.png|.JPG|.JPEG|.GIF|.PNG)/)) {
        f.sm[flag].src = event.srcElement.value;
        f.sm[flag].style.display = '';

        if(f.sm[flag].fileSize > 1000*1024){ 
        document.images[img_pre].style.display = 'none';
        alert("1000k 이상은 업로드 하실수 없습니다.");
        }
    }
    else {
        document.images[img_pre].style.display = 'none';

        if(f.sm.fileSize ==-1){
        alert("이미지 파일만 가능합니다");
        }
    }

    AutoResize(imgsize, flag);
    }                

}


//이미지 원래크기로 팝업창 띄우기/////////////////////////////////
function AutoResize1(img){ 
  foto1= new Image(); 
  foto1.src=(img); 
  Controlla1(img); 
} 
function Controlla1(img){ 
  if((foto1.width!=0)&&(foto1.height!=0)){ 
    viewFoto1(img); 
  } 
  else{ 
    funzione="Controlla('"+img+"')"; 
    intervallo=setTimeout(funzione,20); 
  } 
} 
function viewFoto1(img){ 
  largh=foto1.width; 
  altez=foto1.height;
  if(largh >= 1024 && 768 <= altez) {
      largh = 1024;
   }
   if(largh <= 1024 && altez >= 768) {
      largh = largh + 40;
      altez = 768;
   }
   if(largh >= 1024 && altez >= 768) {
      largh = 1024;
      altez = 768;
   }
  stringa="width="+largh+",height="+altez+",left=0,top=0,scrollbars=yes"; 
  finestra=window.open(img,"",stringa);
  
} 
-->
</script>

<table class="table_outline">
  <tr>
    <td valign="top"><fieldset class="desc">
      <legend>제품등록</legend>
      <div id="notice">[note]</div>
      <div id="comment"> 제품을 카테고리에 맞게 분류하여 등록하십시오.<br />
                  등록카테고리를 지정하실 때에는 가장 하위 카테고리에 등록해 주시기 바랍니다. <br />
                  스킨마다 약간식의 적용 옵션이 달라 질 수 도 있습니다.</div>
      </fieldset>
      <br />
      <form  action='<?=$PHP_SELF?>' method='post' NAME="writeForm" enctype='multipart/form-data' onsubmit='return checkForm(this);'>
        <INPUT type=hidden name='query' value='<?=$mode;?>'>
        <INPUT TYPE=HIDDEN NAME=menushow VALUE=<?=$menushow?>>
        <INPUT TYPE=HIDDEN NAME=theme VALUE=<?=$theme?>>
        <input type="hidden" name="SimilarPd">
        <INPUT type=hidden name='uid' value='<?=$uid?>'>
        <INPUT type=hidden name='back' value='<?=$back?>'>
        <!-- 아래는 수정모드에서 넘어온 조건(분류라던지 검색조건)을 다시 한번 보내준다 -->
        <INPUT type=hidden name='where' value='<?=$where?>'>
        <INPUT type=hidden name='keyword' value='<?=$keyword?>'>
        <INPUT type=hidden name='OPTI_LIST' value='<?=$OPTI_LIST?>'>
        <INPUT type=hidden name='sort' value='<?=$sort?>'>
        <INPUT type=hidden name='sort1' value='<?=$sort1?>'>
        <input type=hidden name='sort2' value='<?=$sort2?>' />
        <INPUT type=hidden name='sorting' value='<?=$sorting?>'>
		<INPUT type=hidden name='s_category' value='<?=$category?>'>
        <INPUT type=hidden name='cp' value='<?=$cp?>'>
        <INPUT type=hidden name='c_category' value='<?=$list["Category"]?>'>
        <INPUT type=hidden name='htmleditimgfolder' value='<?=$htmleditimgfolder?>'>
        <!-- 다중카테고리용으로 히든 값을 보낸다. 5개 이상 보내고 싶을 경우 이 부분의 hindden 값을 조정 -->
        <INPUT type=hidden id=TmpMultiCategoryvalue name='TmpMultiCategoryvalue' value=''>
        <table class="table_main">
          <TR>
            <TD width=96 bgColor=E0E4E8  style="padding: 0 10 0 5">등록카테고리</TD>
            <TD bgColor=#ffffff width="639">&nbsp;
              <select name="Category1" id="Category1" onchange="getCategory(this, 1);">
                <option value="" selected>대분류 </option>
                <option value="">----------------</option>
<?
$mall->getSelectCategory("1", $list["Category"]);
?>
              </select>
              <select name="Category2" id="Category2" onchange="getCategory(this, 2);">
                <option value="" selected>중분류</option>
                <option value="">----------------</option>
<?
if($mode == "qup"){
$mall->getSelectCategory("2", $list["Category"]);
}
?>				
              </select>
              <select name="Category3" id="Category3">
                <option value="" selected>소분류</option>
                <option value="">----------------</option>
<?
if($mode == "qup"){
$mall->getSelectCategory("3", $list["Category"]);
}
?>
              </select>
              (등록카테고리가 없을시 카테고리를 <A href="<?=$PHP_SELF?>?menushow=<?=$menushow?>&theme=catmanager/shopmanager1">등록</A> 하세요)</TD>
          </TR>
          <TR>
            <TD width=96 height="25" bgColor=E0E4E8  style="padding: 0 10 0 5">다중카테고리</TD>
            <TD bgColor=#ffffff width="639"><table width="100%" border="0" cellspacing="0" cellpadding="0">
                <tr>
                  <td width="50%" valign="top">&nbsp;
                    <select style="WIDTH: 270px" name="" onchange="MultiCategorySelect(this)">
                      <option value=''>상품등록 카테고리 선택</option>
                      <option value=''>--------------------------------------</option>
                      <?
$substr = "SELECT cat_no, cat_name FROM wizCategory WHERE LENGTH(cat_no) = 3 and cat_flag = 'wizmall' ORDER BY cat_order ASC";
$subqry = $dbcon->_query($substr);
while($sublist=@$dbcon->_fetch_array($subqry)):
	if($sublist["cat_no"]==$list["Category"]) ECHO "<OPTION VALUE='$sublist[cat_no]' selected>$sublist[cat_name]</OPTION>\n";
	else ECHO "<OPTION VALUE='$sublist[cat_no]'>$sublist[cat_name]</OPTION>\n";
	$cat_no_new = substr($sublist[cat_no],4);
	$substr1 = "SELECT cat_no, cat_name FROM wizCategory WHERE LENGTH(cat_no) = 6 AND RIGHT(cat_no, 3) = '".$sublist["cat_no"]."' and cat_flag = 'wizmall' ORDER BY cat_order ASC";
	$subqry1 = $dbcon->_query($substr1);
	while($sublist1=@$dbcon->_fetch_array($subqry1)):
		if($sublist1[cat_no]==$list[Category]) ECHO "<OPTION VALUE='$sublist1[cat_no]' selected>$sublist[cat_name] > $sublist1[cat_name]</OPTION>\n";
		else ECHO "<OPTION VALUE='$sublist1[cat_no]'>$sublist[cat_name]> $sublist1[cat_name]</OPTION>\n";
		$cat_no_new1 = substr($sublist1[cat_no],2);
		$substr2 = "SELECT cat_no, cat_name FROM wizCategory WHERE LENGTH(cat_no) = 9 AND RIGHT(cat_no, 6) = '".$sublist1["cat_no"]."' and cat_flag = 'wizmall' ORDER BY cat_order ASC";
		$subqry2 = $dbcon->_query($substr2);
		while($sublist2=@$dbcon->_fetch_array($subqry2)):
		if($sublist2[cat_no]==$list[Category]) ECHO "<OPTION VALUE='$sublist2[cat_no]' selected>$sublist[cat_name] > $sublist1[cat_name] > $sublist2[cat_name]</OPTION>\n";
		else ECHO "<OPTION VALUE='$sublist2[cat_no]'>$sublist[cat_name] > $sublist1[cat_name] > $sublist2[cat_name]</OPTION>\n";
		endwhile;
	endwhile;
endwhile;	
?>
                    </select></td>
                  <td valign="top"><select name="TmpMultiCategory" size="5" multiple>
                      <?
$sqlsubstr = "select Category from wizMall where PID = '$uid' and UID != '$uid'";
$sqlsubqry = $dbcon->_query($sqlsubstr);
while($sublist = $dbcon->_fetch_array($sqlsubqry)): 
		$mul_cat = $sublist[Category];
		$mul_cat_len =strlen($mul_cat);
	if($mul_cat_len > 0){
		$sqlcatstr = "select cat_name from wizCategory where cat_no = '".substr($mul_cat, -3)."' and cat_flag = 'wizmall'";
		$cat_name = $dbcon->get_one($sqlcatstr);
	}
	if($mul_cat_len > 3){
		$sqlcatstr = "select cat_name from wizCategory where cat_no = '".substr($mul_cat, -6)."' and cat_flag = 'wizmall'";
		$cat_name .= ">".$dbcon->get_one($sqlcatstr);
	}
	if($mul_cat_len > 6){
		$sqlcatstr = "select cat_name from wizCategory where cat_no = '$mul_cat' and cat_flag = 'wizmall'";
		$cat_name .= ">".$dbcon->get_one($sqlcatstr);
	}
?>
                      <option value="<?=$sublist[Category]?>">
                      <?=$cat_name?>
                      </option>
                      <?
endwhile;
?>
                    </select>
                    <input name="button" type=button onClick=DeleteMultiCat(this.form.TmpMultiCategory) value=제거>
                    <a href="javasript:window.open('http://shop-wiz.com/wizmanual.php?BID=manual&mode=view&UID=2&cp=1&BOARD_NO=1&SEARCHTITLE=&searchkeyword=&category=2','OnlineManual','width=500, height=400,scrollbars=yes,resizable=yes')";><img src="../../wizboard/images/help.gif" width="20" height="9" border="0"></a></td>
                </tr>
              </table></TD>
          </TR>
          <TR>
            <TD width=96 bgColor=E0E4E8 height=40 style="padding: 0 10 0 5">상품명</TD>
            <TD bgColor=#ffffff height=40 width="639">&nbsp;
              <INPUT 
                        name=Name value="<?=$list[Name]?>" size=26>
              &nbsp;</TD>
          </TR>
          <TR>
            <TD width=96 bgColor=E0E4E8 style="padding: 0 10 0 5">상품모델명</TD>
            <TD bgColor=#ffffff width="639">&nbsp;
              <INPUT name=Model value="<?=$list[Model]?>" size=26>
              <FONT face=돋움 size=2>- 사용하지 않을경우 공백처리</FONT></TD>
          </TR>
          <TR>
            <TD width=96 bgColor=E0E4E8 height=35 style="padding: 0 10 0 5">판매가<br />
            (즉시구매가)</TD>
            <TD bgColor=#ffffff height=35 width="639">&nbsp;
              <INPUT name=Price value="<?=$list["Price"]?$list["Price"]:0;?>" size=26>
              콤마(,)없이 숫자로만 입력(보기:10000)</TD>
          </TR>
          <TR>
            <TD width=100 bgColor=E0E4E8 height=25 style="padding: 0 10 0 5">소비자가</TD>
            <TD bgColor=#ffffff height=25>&nbsp;
              <INPUT name=Price1 value="<?=$list[Price1]?>" 
                        size=26 maxLength=30>
              콤마(,)없이 숫자로만 입력(보기:10000)- 사용하지 않을경우 공백처리</TD>
          </TR>          
          <TR>
            <TD width=96 bgColor=E0E4E8 style="padding: 0 10 0 5">부가
                포인트</TD>
            <TD bgColor=#ffffff width="639">&nbsp;
              <INPUT name=Point value="<?=$list[Point]?>" size=26>
              이 상품에 부가할 마일리지포인트. </TD>
          </TR>
          <TR>
            <TD width=96 bgColor=E0E4E8 style="padding: 0 10 0 5">공동구매
              <input name="cobuy" type="checkbox" id="cobuy" value="c" <? if($list["opflag"]=="c") echo "checked";?> onclick="dp_coorbuy(this);">            </TD>

            <TD bgColor=#ffffff width="639">&nbsp;공동구매시 이곳에 책크(공동구매는 일반 매장이 아니라 공동 구매 매장에만 디스플레이)</TD>
          </TR> 
          <TR style="display:none" id="cobuyfield">
            <TD colspan="2" bgColor=#FFFFFF style="padding: 0 10 0 5">            
            <table cellspacing=1 bordercolordark=white width="100%" 
                  align=center bgcolor=#c0c0c0 bordercolorlight=#dddddd 
border=0 class="s1">
  <tr>
    <td width=100 bgcolor=E0E4E8 height=35>*차등가격적용 </td>
    <td bgcolor=#ffffff height=35><table cellspacing=0 cellpadding=0 width="100%" 
border=0 class="s1">
        <tr>
          <td>- 신청수량이
            <input name="c_qty[0]" value="<?=$p_qty[0][1];?>" size=5>
            개 이상일때
            <input 
                              name="c_price[0]" onKeyPress=is_number() value="<?=$p_qty[0][0];?>" size=15>
            원(하위로 5, 10, 20... 순으로 입력)</td>
        </tr>
        <tr>
          <td>- 신청수량이
            <input name="c_qty[1]" value="<?=$p_qty[1][1];?>" size=5>
            개 이상일때
            <input 
                              name="c_price[1]" onKeyPress=is_number() value="<?=$p_qty[1][0];?>" size=15>
            원</td>
        </tr>
        <tr>
          <td>- 신청수량이
            <input name="c_qty[2]" value="<?=$p_qty[2][1];?>" size=5>
            개 이상일때
            <input 
                              name="c_price[2]" onKeyPress=is_number() value="<?=$p_qty[2][0];?>" size=15>
            원</td>
        </tr>
      </table></td>
  </tr>
  <tr>
    <td width=100 bgcolor=E0E4E8 height=35>*공동구매기간 </td>
    <td bgcolor=#ffffff height=35>&nbsp;
    
    <?
$common->startyear = date("Y");
$common->getSelectDate($SDate);
?>
                            &nbsp;
                            <select name='SYear' size='1'>
                              <?=$common->rtn_year ?>
                            </select>
                            <select name='SMonth' size='1'>
                              <?=$common->rtn_month ?>
                            </select>
                            <select name='SDay' size='1'>
                              <?=$common->rtn_day ?>
                            </select>
                            ~
                            <?
$common->getSelectDate($FDate);
?>
                            <select name='FYear' size='1'>
                              <?=$common->rtn_year ?>
                            </select>
                            <select name='FMonth' size='1'>
                              <?=$common->rtn_month ?>
                            </select>
                            <select name='FDay' size='1'>
                              <?=$common->rtn_day ?>
                            </select></td>
  </tr>
</table><script language="javascript">dp_coorbuy(document.writeForm.cobuy)</script></TD>
          </TR>                    
          <TR>
            <TD height=35 colspan="2" valign="middle" bgColor="#FFFFFF">이미지 copy
              <input type="checkbox" name="checkbox" id="checkbox" />
              (큰그림은 반드시 넣어시고 작은/중간 그림은 선택)<br />
              <select name="watermark" id="watermark" onchange="dp_watermark(this)">
                <option>워터마크적용</option>
                <option value="text">텍스트적용</option>
                <option value="img">이미지적용</option>
              </select>
            
              <input name="watermark_text" type="text" id="watermark_text" value="<?=$cfg["admin"]["str_watermark"]?>"  style="display:none" />
              <input type="text" name="watermark_img" id="watermark_img" value="<?=$cfg["admin"]["img_watermark"]?>"  style="display:none" />     [<a href="javascript:gotobasicinfo()">기본 텍스트/이미지 수정하기</a>]</TD>
          </TR>          
          <TR>
            <TD width=96 bgColor=E0E4E8 height=35 style="padding: 0 10 0 5"><P>큰그림</P></TD>
            <TD bgColor=#ffffff height=35 width="639"> 
              <table border="0" cellpadding="0" cellspacing="0" height="18">
                <tr>
                  <td><INPUT type='file' name='file[]'></td>
                  <td class="s1">
                    <? if($fileimg[0]): ?>
                    <a href='../config/uploadfolder/productimg/<?=$imgFolder?>/<?=$fileimg[0]?>' target=_blank><img src ='../config/uploadfolder/productimg/<?=$imgFolder?>/<?=$Picture[0]?>' width = 30 border="0"></a>
                    <?=$common->getImgName($fileimg[0])?>
                    <?endif;?>
                    (권장사이즈 : 500 x 500)(상세보기팝업이미지)</td>
                </tr>
              </table>              </TD>
          </TR>
          <TR>
            <TD width=96 bgColor=E0E4E8 height=35 style="padding: 0 10 0 5"><P>작은그림<br />
              (copy
            <input name="copyimg[1]" type="checkbox" id="copyimg[1]" value="1" />
            )</P></TD>
            <TD bgColor=#ffffff height=35 width="639"> 
              <table border="0" cellpadding="0" cellspacing="0" height="18">
                <tr>
                  <td><INPUT type='file' name='file[]'></td>
                  <td class="s1">
                    <? if($fileimg[1]): ?>
                    <a href='../config/uploadfolder/productimg/<?=$imgFolder?>/<?=$fileimg[1]?>' target=_blank><img src ='../config/uploadfolder/productimg/<?=$imgFolder?>/<?=$fileimg[1]?>' width = 30 border="0"></a>
                    <?=$common->getImgName($Picture[1])?>
                    <?endif;?>
                    (권장사이즈 : 100 x 100)리스트이미지</td>
                </tr>
              </table>              </TD>
          </TR>
          <TR>
            <TD width=96 bgColor=E0E4E8 height=35 style="padding: 0 10 0 5"><P>중간그림<br />
            (copy
              <input name="copyimg[2]" type="checkbox" id="copyimg[2]" value="1" />
            )</P></TD>
            <TD bgColor=#ffffff height=35 width="639"> 
              <table border="0" cellpadding="0" cellspacing="0" height="18">
                <tr>
                  <td><INPUT type='file' name='file[]'></td>
                  <td class="s1">
                    <? if($fileimg[2]): ?>
                    <a href='../config/uploadfolder/productimg/<?=$imgFolder?>/<?=$fileimg[2]?>' target=_blank><img src ='../config/uploadfolder/productimg/<?=$imgFolder?>/<?=$fileimg[2]?>' width = 30 border="0">
                    <?endif;?>
                    </a>
                    <?=$common->getImgName($Picture[2])?>
                    (권장사이즈 : 300 x 300) 상세보기 큰이미지</td>
                </tr>
              </table>              </TD>
          </TR>                    
          <TR>
            <TD width=96 bgColor=E0E4E8 height=35 style="padding: 0 10 0 5"><P>기타그림</P></TD>
            <TD bgColor=#ffffff width="639">
              <table border="0" cellpadding="0" cellspacing="0" height="18">
                <? 
				//$PictureCount = $uid ? sizeof($$fileimg) : 3;
				for($i=3; $i<=$max_value; $i++){ 
				?>
                <tr>
                  <td width="250"><INPUT type='file' name='file[]' class='dd1'></td>
                  <td class="s1"><?if($fileimg[$i]):?>
                    <a href='../config/uploadfolder/productimg/<?=$imgFolder?>/<?=$fileimg[$i]?>' target=_blank><img src ='../config/uploadfolder/productimg/<?=$imgFolder?>/<?=$fileimg[$i]?>' width = 30 border="0"></a>
                    <?=$common->getImgName($fileimg[$i])?>
                    <?endif;?>
                    &nbsp;&nbsp;
                  <input type="button" value="삭제" onClick = "del('<?=$uid?>','<?=$i?>');"></td>
                </tr>
                <?}?>
              </table>
              <table border="0" cellpadding="0" cellspacing="0" height="18">
                <tr>
                  <td width="250"><div id='nameToDiv'></div></td>
                  <td width="75" valign="bottom" class="s1"><div align="center"><img src="img/chu.gif" width="68" height="20" style="cursor:pointer" value="추가하기" onClick="javascript:addToPIC() ;return false";></div></td>
                </tr>
              </table></TD>
          </TR>

          <TR>
            <TD width=96 bgColor=E0E4E8 style="padding: 0 10 0 5">자세한설명
              <label></label>
            <INPUT type=hidden value="1" name="des_type1">            </TD>
            <TD bgColor=#ffffff width="639">
              <TEXTAREA name="Description1" rows=20 id="Description1" style="width:98%"><?=$list[Description1]?>
            </TEXTAREA>
			<script>HTMLArea.init(); HTMLArea.onload = initEditor</script> 
			&lt;P&gt;-&gt;Enter, &lt;BR&gt;-&gt;Shift+Enter</TD>
          </TR>
          <TR>
            <TD width=96 bgColor=E0E4E8>배송정보<br />
              <input name="des_type3" type="checkbox" value="1" <? echo $des_type3=="1"?"checked":"";?>>
              HTML사용
              <DIV align=center></DIV></TD>
            <TD bgColor=#ffffff width="639"><P>&nbsp;
                <TEXTAREA id=Description3 name=Description3 rows=6  style="width:98%"><?=$list[Description3]?></TEXTAREA>
                <br />
                </P></TD>
          </TR>
          <TR>
            <TD bgColor=E0E4E8 width="96" style="padding: 0 10 0 5">간단한
                설명</TD>
            <TD bgColor=#ffffff width="639">&nbsp;
              <TEXTAREA name=Description2 rows=3  style="width:98%"><?=$list[Description2]?></TEXTAREA>
              <br />
              <br />
              상품에 대한 간단한 설명을 넣는 곳입니다. 스킨에 따라 적용되지 않을 수도 있습니다.<br />              </TD>
          </TR>
        </TABLE>
        <br />
        <table width="750" border="0" cellpadding="0" cellspacing="0">
          <tr>
            <td><div align="center">
                <input type="image" src="img/sul.gif" width="68" height="20">
              </div></td>
          </tr>
        </table>
        <br />
        <br />
        <span class="s1">  옵션 입력사항</span>
        <table class="table_main">
          <TR>
<?
##옵션관련 정보를 불러온다
$substr = "select count(1) from wizMalloptioncfg where opid = '$uid'";
$subqry = $dbcon->_query($substr);
$sublist = $dbcon->_fetch_array($subqry);
$optioncnt = $sublist[0];
if(!$optioncnt) $optioncnt = 0;
?>          
<input type="hidden" name="optioncntadd" value="<?=$optioncnt?>" />
            <TD width=100 bgColor=E0E4E8 style="padding: 0 10 0 5">옵션설정</TD>
            <TD bgColor=#ffffff>&nbsp;
              <select name="optioncnt" id="optioncnt" onchange="listOptionCnt(this, '<?=$optioncnt?>')">
                <option value="0">갯수</option>
                <?
				for($i=1; $i<=5; $i++){
					$selected = $optioncnt == $i ? " selected":"";
					echo "<option value='$i'$selected>$i</option>\n";
				}
				?>
              </select>
            (옵션필드갯수:색상, 사이즈, 인치...)
           
            <br />
            가격추가나 원가격변동은 택1하여 사용해 주시기 바랍니다.<br />
            옵션당 한개의 값만 입력하시면 단일 텍스트가 출력됩니다.
            <?
$substr = "select * from wizMalloptioncfg where opid = '$uid' order by oorder asc";
$subqry = $dbcon->_query($substr);
$cnt=0;
while($sublist = $dbcon->_fetch_array($subqry)):
$oname	= $sublist["oname"];
$oflag	= $sublist["oflag"];
$ouid = $sublist["uid"];

//옵션값갯수구하기
$substr1 = "select count(1) from wizMalloption where ouid = '$ouid'";
$subqry1 = $dbcon->_query($substr1);
$sublist1 = $dbcon->_fetch_array($subqry1);
$valuecnt = $sublist1[0];
if(!$valuecnt) $valuecnt = 0;
?>           
            <table  cellpadding=8 cellspacing=0 id='objOption' bgcolor=f3f3f3 border=0 bordercolor=#cccccc style='border-collapse:collapse' class='s1'>
		<tr>
		<td valign='top' id=currPosition>옵션명 : <INPUT name='opname[<?=$cnt;?>]' class='dd1' value='<?=$oname?>' size=10> 
		<select name='opcnt[<?=$cnt;?>]' onChange="listeachOptionCnt(this, <?=$cnt;?>, '<?=$valuecnt?>')" style="width:50px">
		<option value='0'>갯수</option>
                <?
				for($i=1; $i<=10; $i++){
					$selected = $valuecnt == $i ? " selected":"";
					echo "<option value='$i'$selected>$i</option>\n";
				}
				?>
		</select> 
		<select name='opflag[<?=$cnt;?>]' style="width:90px"> 
		<option value='0' selected='selected'>기본</option> 
		<option value='1'<? if($oflag == "1") echo " selected"; ?>>가격추가</option>
		<option value='2'<? if($oflag == "2") echo " selected"; ?>>원가격변경</option>
		</select> <input type="button" name="button2" id="button" value="del" onClick="option_del(this.parentNode.parentNode)"style='cursor:pointer'></td>
		<td valign='middle'> 
<?
$substr1 = "select * from wizMalloption where ouid = '$ouid' order by uid asc";
$subqry1 = $dbcon->_query($substr1);
$subcnt=0;
while($sublist1 = $dbcon->_fetch_array($subqry1)):
?>  	
       <table border='0' cellspacing='0' cellpadding='0' class='s1'>
		<tr>
		<td>옵션값:
		<input name='optioneachname[<?=$cnt;?>][<?=$subcnt?>]' class='dd1' size='9' value='<?=$sublist1["oname"]?>'> 
		가격:
		<input name='optioneachprice[<?=$cnt;?>][<?=$subcnt?>]' class='dd1' size='5' value='<?=$sublist1["oprice"]?>'> 
		재고: 
		<input name='optioneachqty[<?=$cnt;?>][<?=$subcnt?>]' class='dd1' size='3' value='<?=$sublist1["oqty"]?>'>
		<input type="button" name="button2" id="button" value="del" onClick="option_del(this.parentNode.parentNode)"style='cursor:pointer'></td>
		</tr></table>
		
<?
$subcnt++;
endwhile;//while($sublist1 = $dbcon->_fetch_array($subqry1)):
?><span id='add_optioneach_<?=$cnt?>'></span> </td>
		</tr>
	</table> 	
<?
$cnt++;
endwhile;//while($sublist = $dbcon->_fetch_array($subqry)):
?>             

<span id="add_option">
</span>
			</TD>
          </TR>        
          <TR>
            <TD width=100 bgColor=E0E4E8 style="padding: 0 10 0 5">브랜드명</TD>
            <TD bgColor=#ffffff>&nbsp;
              <INPUT name="Brand" value="<?=$list[Brand]?>" size=26 maxLength=30></TD>
          </TR>
          <TR>
            <TD width=100 bgColor=E0E4E8 style="padding: 0 10 0 5">제조사</TD>
            <TD bgColor=#ffffff>&nbsp;
              <INPUT name="CompName" value="<?=$list[CompName]?>" size=26 maxLength=30></TD>

          </TR>
          <TR>
            <TD width=100 bgColor=E0E4E8 style="padding: 0 10 0 5">등록옵션</TD>
            <TD bgColor=#ffffff><table width="100%" border="0" cellspacing="0" cellpadding="0" class="s1">
                <tr>
                  <td>&nbsp; 
                    <?
reset($RegOptionArr);
$RegoptionArr = split("\|", $list[Regoption]);
while(list($key, $value)=each($RegOptionArr)):
	if($RegoptionArr[$key]) $checked = "checked";
	else unset($checked);
	echo "<input type='checkbox' name='Multi_Regoption[".$key."]' value='1' $checked >".$value."&nbsp; ";
endwhile;
?>
                      </td>
                </tr>
              </table></TD>
          </TR>
          <TR>
            <TD width=100 bgColor=E0E4E8 style="padding: 0 10 0 5">비교상품</TD>
            <TD bgColor=#ffffff><table width="100%" border="0" cellspacing="0" cellpadding="0" class="s1">
                <tr>
                  <td>&nbsp;
                  
                    비교상품을 디스플레이 하기위해서는 기본환경&gt;몰스킨설정&gt;상세보기스킨&gt; 관련상품표시하기를 책크해 두셔야 합니다.
                      <select name="tmpSimilarPd" size="6"  multiple="multiple" style="width:100%" readonly>
                      <?
$mall->getSimilarPd($SimilarPd);
?>
                    </select>
                
                  <input type="button" name="Button" value="찾기" onClick="window.open('product/product1_1search.php?mode=compare&sort='+document.writeForm.Category1.value+'&sort1='+document.writeForm.Category2.value+'&sort2='+document.writeForm.Category3.value+'&mode=new','Product_Search_Window','width=620, height=650, scrollbars=yes')"; style="cursor:pointer">                  </td>
                </tr>
              </table></TD>
          </TR>
          <tr>
            <td height="25" bgcolor=E0E4E8 style="padding: 0 10 0 5">등록일</td>
            <td bgcolor=#ffffff><?
$year = date("Y");
$month = date("m");
$day = date("j");
if($list[Date]){
	$regyear = date("Y", $list[Date]);
	$regmonth = date("m", $list[Date]);
	$regday = date("d", $list[Date]);
}else{
	$regyear = $year;
	$regmonth = $month;
	$regday = $day;
}
ECHO "<select name='Year' size='1'>";
for($i=$regyear;$i<=$year+5;$i++) {
if($regyear == $i) {
echo "<option value='$i' selected>$i</option>\n";
}
else {
echo "<option value='$i'>$i</option>\n";
}
}
echo "</select>년 <select name='Month' size='1'>";
for($i="01";$i<=12;$i++) {
if($regmonth == $i) {
echo "<option value='$i' selected>$i</option>\n";
}
else {
echo "<option value='$i'>$i</option>\n";
}
}
echo "
</select>월 <select name='Day' size='1'>";
for($i="01";$i<=31;$i++) {
if($regday == $i) {
echo "<option value='$i' selected>$i</option>\n";
}
else {
echo "<option value='$i'>$i</option>\n";
}
}
echo "</select>일";
?>
              &nbsp;<a href="#" onClick="window.open('http://shop-wiz.com/wizmanual.php?BID=manual&mode=view&UID=8&searchkeyword=&category=2','OnlineManual','width=500, height=400,scrollbars=yes,resizable=yes')";><img src="../../wizboard/images/help.gif" width="20" height="9" border="0"></a> (for
              more info, click &quot;?&quot;)</td>
          </tr>
        </TABLE>
        <br />
        <table class="table_main">
          <tr>
            <td width=100 bgcolor=E0E4E8 style="padding: 0 10 0 5">품절</td>
            <td bgcolor=#ffffff>&nbsp;
              <input type=checkbox value="1" name="None" <? if($list["None"] == "1") echo "checked"; ?>>
              품절상품은 리스트는 되나 장바구니에 담겨지지 않습니다.</td>
          </tr>
          <TR>
            <TD width=100 bgColor=E0E4E8 style="padding: 0 10 0 5">공급처</TD>
            <TD bgColor=#ffffff>&nbsp;
              <SELECT name=GetComp>
                <OPTION VALUE=''>공급거래처 없음</OPTION>
                <OPTION VALUE=''>------------------</OPTION>
                <?
$sqlcompstr = "SELECT UID,CompName,CompID FROM wizCom WHERE (CompSort = '01' or CompSort = '02' or CompSort = '03')";
$sqlcompqry = $dbcon->_query($sqlcompstr);
while( $complist = $dbcon->_fetch_array( $sqlcompqry ) ) {
unset($selected);
if(!strcmp(trim($complist[CompID]),trim($list[GetComp]))) $selected = " selected";
        ECHO "<OPTION VALUE='$complist[CompID]'$selected>$complist[CompName]</OPTION>";
}
?>
              </SELECT>
              (공급처가 없을시 공급처를 <A href="<?=$PHP_SELF?>?menushow=<?=$menushow?>&theme=member/basic_info5_1">등록</A> 하세요) </TD>
          </TR>
          <TR>
            <TD width=100 bgColor=E0E4E8 height=25 style="padding: 0 10 0 5">원가 </TD>
            <TD bgColor=#ffffff height=25>&nbsp;
              <INPUT name="WongaPrice" value="<?=$list[WongaPrice]?>" 
                        size=26 maxLength=30>
              콤마(,)없이 숫자로만 입력(보기:10000) - 원 상품가</TD>
          </TR>
          <tr>
            <td width=100 height="25" bgcolor=E0E4E8 style="padding: 0 10 0 5">단위</td>
            <td bgcolor=#ffffff>&nbsp;
              <input name="Unit" value="<?=$list[Unit]?>" size=5>
            </td>
          </tr>
          <tr>
            <td width=100 height="25" bgcolor=E0E4E8 style="padding: 0 10 0 5">재고수량<br />
            (공동구매수량)</td>
            <td bgcolor=#ffffff>&nbsp;
              
			  <? if($uid){ ?>
			  현재고수량: <?=$list["Stock"]?><?=$list[Unit]?> 
              (입하량의 추가/변경 일경우 <a href="javascript:wizwindow('./product/product2_2.php?uid=<?=$uid?>&Name=<?=$list[Name]?>&Output=<?=$list[Output]?>&Icomid=<?=$list[GetComp]?>','InputChangeWindow','width=300, height=300')">이곳을
              눌러</a> 변경해 주세요)
			  <?
			  }else{
			  ?>
			  <input name="Stock" value="" size=5>
			  <?
			  }
			  ?></td>
          </tr>		  
        </table>
        <br />
        <table width="760" border="0" cellpadding="0" cellspacing="0">
          <tr>
            <td><div align="center">
                <input type="image" src="img/sul.gif" width="68" height="20">
              </div></td>
          </tr>
        </table>
      </form></td>
  </tr>
</table>
